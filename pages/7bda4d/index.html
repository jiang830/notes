<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.26" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <title>Docker Composeé¡¹ç›®éƒ¨ç½²</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-CV-aSyL0.css" as="style"><link rel="stylesheet" href="/assets/style-CV-aSyL0.css">
    <link rel="modulepreload" href="/assets/app-CT4bPn0M.js"><link rel="modulepreload" href="/assets/index.html-Db4ciJxl.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-CSpmhHeK.js" as="script"><link rel="prefetch" href="/assets/index.html--2R5vsdh.js" as="script"><link rel="prefetch" href="/assets/index.html-BnXtwsXL.js" as="script"><link rel="prefetch" href="/assets/index.html-B7hYqSw6.js" as="script"><link rel="prefetch" href="/assets/index.html-DUyfniXY.js" as="script"><link rel="prefetch" href="/assets/index.html-BKnH3ub0.js" as="script"><link rel="prefetch" href="/assets/index.html-BGvXNw7H.js" as="script"><link rel="prefetch" href="/assets/index.html-DKvIwItS.js" as="script"><link rel="prefetch" href="/assets/index.html-BLFHdWAv.js" as="script"><link rel="prefetch" href="/assets/é˜¿é‡Œäº‘é¢è¯•é¢˜.html-67Gclmd5.js" as="script"><link rel="prefetch" href="/assets/index.html-Coth3iwF.js" as="script"><link rel="prefetch" href="/assets/index.html-DL1BW0Yy.js" as="script"><link rel="prefetch" href="/assets/index.html-Cv7ToGV2.js" as="script"><link rel="prefetch" href="/assets/index.html-CiOSF6nN.js" as="script"><link rel="prefetch" href="/assets/index.html-wgNrMjyX.js" as="script"><link rel="prefetch" href="/assets/index.html-DMtMjVx-.js" as="script"><link rel="prefetch" href="/assets/index.html-D7jwlDKQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CU5_oyTi.js" as="script"><link rel="prefetch" href="/assets/index.html-Bq6U-nqM.js" as="script"><link rel="prefetch" href="/assets/index.html-BxoJLgxp.js" as="script"><link rel="prefetch" href="/assets/index.html-B04c0mD5.js" as="script"><link rel="prefetch" href="/assets/index.html-gaD97CLH.js" as="script"><link rel="prefetch" href="/assets/index.html-nv6Kc-Od.js" as="script"><link rel="prefetch" href="/assets/index.html-OXo_SpP2.js" as="script"><link rel="prefetch" href="/assets/index.html-DGBnV6QP.js" as="script"><link rel="prefetch" href="/assets/index.html-DRfvV7TW.js" as="script"><link rel="prefetch" href="/assets/index.html-4TFYILmP.js" as="script"><link rel="prefetch" href="/assets/index.html-CGfXoegH.js" as="script"><link rel="prefetch" href="/assets/index.html-DMW40kv2.js" as="script"><link rel="prefetch" href="/assets/index.html-BLfh2K27.js" as="script"><link rel="prefetch" href="/assets/index.html-FnU2NHSk.js" as="script"><link rel="prefetch" href="/assets/index.html-CVyeJ0nv.js" as="script"><link rel="prefetch" href="/assets/index.html-CtS7Hbk_.js" as="script"><link rel="prefetch" href="/assets/index.html-CS-yKKXA.js" as="script"><link rel="prefetch" href="/assets/index.html-g5I17pEN.js" as="script"><link rel="prefetch" href="/assets/index.html-pNX6YByX.js" as="script"><link rel="prefetch" href="/assets/index.html-WBck0DLr.js" as="script"><link rel="prefetch" href="/assets/index.html-R6fBvdOR.js" as="script"><link rel="prefetch" href="/assets/index.html-CRR46Q79.js" as="script"><link rel="prefetch" href="/assets/index.html-X36h9xAV.js" as="script"><link rel="prefetch" href="/assets/index.html-B9-qp9Zv.js" as="script"><link rel="prefetch" href="/assets/index.html-BRwRkKjq.js" as="script"><link rel="prefetch" href="/assets/index.html-DkNN0Ggn.js" as="script"><link rel="prefetch" href="/assets/index.html-BevbfSBP.js" as="script"><link rel="prefetch" href="/assets/index.html-DGKoOKvk.js" as="script"><link rel="prefetch" href="/assets/index.html-CczDofwy.js" as="script"><link rel="prefetch" href="/assets/index.html-DrRa28Ct.js" as="script"><link rel="prefetch" href="/assets/index.html-CsU1DR0W.js" as="script"><link rel="prefetch" href="/assets/index.html-Dlzay4Hw.js" as="script"><link rel="prefetch" href="/assets/index.html-LsMzeSDA.js" as="script"><link rel="prefetch" href="/assets/index.html-CHbiAsYT.js" as="script"><link rel="prefetch" href="/assets/00.åˆ†å¸ƒå¼äº‹åŠ¡ç»„ä»¶Seata.html-DvBICF5t.js" as="script"><link rel="prefetch" href="/assets/index.html-RaZGZNi3.js" as="script"><link rel="prefetch" href="/assets/index.html-D3wsEvzo.js" as="script"><link rel="prefetch" href="/assets/index.html-JrOC7KC5.js" as="script"><link rel="prefetch" href="/assets/index.html-By_gwF0J.js" as="script"><link rel="prefetch" href="/assets/index.html-qWKG5AAK.js" as="script"><link rel="prefetch" href="/assets/index.html-avZIruPQ.js" as="script"><link rel="prefetch" href="/assets/06.MySQLäº‹åŠ¡åŸç†ä¸ä¼˜åŒ–æœ€ä½³å®è·µ.html-CSvQNied.js" as="script"><link rel="prefetch" href="/assets/07.MySQLé”æœºåˆ¶ä¸ä¼˜åŒ–å®è·µä»¥åŠMVCCåº•å±‚åŸç†å‰–æ.html-C23WGqOw.js" as="script"><link rel="prefetch" href="/assets/index.html-Cn4Gzbph.js" as="script"><link rel="prefetch" href="/assets/index.html-uCyFZumH.js" as="script"><link rel="prefetch" href="/assets/index.html-Bm22WFrJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CSd8d20G.js" as="script"><link rel="prefetch" href="/assets/index.html-CvtEazEf.js" as="script"><link rel="prefetch" href="/assets/index.html-BeAXTpGW.js" as="script"><link rel="prefetch" href="/assets/20.ShardingJDBCæºç ä¸å†…æ ¸è§£æ.html-CwyPvd-u.js" as="script"><link rel="prefetch" href="/assets/index.html-DHNMdh3m.js" as="script"><link rel="prefetch" href="/assets/index.html-CCd71ZlA.js" as="script"><link rel="prefetch" href="/assets/index.html-ynJ_kUEc.js" as="script"><link rel="prefetch" href="/assets/index.html-BVfeOYGv.js" as="script"><link rel="prefetch" href="/assets/index.html-CZxOdSnk.js" as="script"><link rel="prefetch" href="/assets/index.html-B-iFN7DD.js" as="script"><link rel="prefetch" href="/assets/index.html-uTIDrkZJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DazyV-CZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DHXS2c57.js" as="script"><link rel="prefetch" href="/assets/index.html-_Fwj-qwX.js" as="script"><link rel="prefetch" href="/assets/index.html-CSa7fUHZ.js" as="script"><link rel="prefetch" href="/assets/index.html-CrqWKted.js" as="script"><link rel="prefetch" href="/assets/index.html-DzjXF5r0.js" as="script"><link rel="prefetch" href="/assets/index.html-QNlXUK6I.js" as="script"><link rel="prefetch" href="/assets/index.html-BDUKsSrh.js" as="script"><link rel="prefetch" href="/assets/index.html-CE1fU4lb.js" as="script"><link rel="prefetch" href="/assets/index.html-IKd9LHPY.js" as="script"><link rel="prefetch" href="/assets/index.html-BNrR4y_n.js" as="script"><link rel="prefetch" href="/assets/index.html-DfI_4yCq.js" as="script"><link rel="prefetch" href="/assets/index.html-0esUAKmz.js" as="script"><link rel="prefetch" href="/assets/index.html-DAH0eLXe.js" as="script"><link rel="prefetch" href="/assets/404.html-BBVwT601.js" as="script"><link rel="prefetch" href="/assets/index.html-9nyom5YJ.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgaj-2Bf.js" as="script"><link rel="prefetch" href="/assets/index.html-BG3rmTga.js" as="script"><link rel="prefetch" href="/assets/index.html-C2MGwNwF.js" as="script"><link rel="prefetch" href="/assets/index.html-oFdCiLjS.js" as="script"><link rel="prefetch" href="/assets/index.html-BsOyCIBe.js" as="script"><link rel="prefetch" href="/assets/index.html-D6eGZPOp.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script"><link rel="prefetch" href="/assets/SearchResult-BFy21v4C.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><!----><!----><!----></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="é¦–é¡µ"><span class="font-icon icon circle-question" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link active" href="/pages/" aria-label="æ–‡æ¡£"><span class="font-icon icon circle-question" style=""></span>æ–‡æ¡£<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">åˆ†å¸ƒå¼</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">å®¹å™¨</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/pages/7bda4d/" aria-label="Docker Composeé¡¹ç›®éƒ¨ç½²"><!---->Docker Composeé¡¹ç›®éƒ¨ç½²<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/pages/01dad9/" aria-label="Dockerfile"><!---->Dockerfile<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/pages/5ae626/" aria-label="Dockerè¯¦è§£ä¸éƒ¨ç½²å¾®æœåŠ¡å®æˆ˜"><!---->Dockerè¯¦è§£ä¸éƒ¨ç½²å¾®æœåŠ¡å®æˆ˜<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/pages/5655a2/" aria-label="ideaåŠ å¯†è¿æ¥æœåŠ¡å™¨docker"><!---->ideaåŠ å¯†è¿æ¥æœåŠ¡å™¨docker<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/pages/d20586/" aria-label="å®¹å™¨è®¿é—®å®¿ä¸»æœºip"><!---->å®¹å™¨è®¿é—®å®¿ä¸»æœºip<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">å¹¶å‘ç¼–ç¨‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">å¾®æœåŠ¡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æ€§èƒ½è°ƒä¼˜</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æºç æ¡†æ¶</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ç®—æ³•</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">è®¡ç®—æœºç½‘ç»œ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">é¢è¯•</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Docker Composeé¡¹ç›®éƒ¨ç½²</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">æ±Ÿ</span></span><span property="author" content="æ±Ÿ"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-11-10T11:14:48.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 17 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT17M"></span><!----><!----></div><hr></div><!----><!--[--><!----><!--]--><div class="theme-hope-content"><p><strong>Docker Composeä»‹ç»</strong></p><p>ä½¿ç”¨å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ç³»ç»Ÿä¸€èˆ¬åŒ…å«è‹¥å¹²ä¸ªå¾®æœåŠ¡ï¼Œæ¯ä¸ªå¾®æœåŠ¡ä¸€èˆ¬éƒ½ä¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ã€‚å¦‚æœæ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰‹åŠ¨å¯åœï¼Œé‚£ä¹ˆæ•ˆç‡ä¹‹ä½ã€ç»´æŠ¤é‡ä¹‹å¤§å¯æƒ³è€ŒçŸ¥ã€‚æœ¬èŠ‚è¯¾å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ Docker Composeæ¥è½»æ¾ã€é«˜æ•ˆåœ°ç®¡ç†å®¹å™¨ã€‚ä¸ºäº†ç®€å•èµ·è§å°† Docker Composeç®€ç§°ä¸º Composeã€‚</p><p>Compose æ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨çš„Dockeråº”ç”¨çš„å·¥å…·ã€‚ä½¿ç”¨Composeï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆyamlæ ¼å¼ï¼‰ä¸­é…ç½®ä½ åº”ç”¨çš„æœåŠ¡ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå³å¯åˆ›å»ºå¹¶å¯åŠ¨é…ç½®ä¸­å¼•ç”¨çš„æ‰€æœ‰æœåŠ¡ã€‚ä¸‹é¢æˆ‘ä»¬è¿›å…¥Composeçš„å®æˆ˜å§</p><p><strong>Docker Composeçš„å®‰è£…</strong></p><p>Composeçš„å®‰è£…æœ‰å¤šç§æ–¹å¼ï¼Œä¾‹å¦‚é€šè¿‡shellå®‰è£…ã€é€šè¿‡pipå®‰è£…ã€ä»¥åŠå°†composeä½œä¸ºå®¹å™¨å®‰è£…ç­‰ç­‰ã€‚æœ¬æ–‡è®²è§£é€šè¿‡shellå®‰è£…çš„æ–¹å¼ã€‚å…¶ä»–å®‰è£…æ–¹å¼å¦‚æœ‰å…´è¶£ï¼Œå¯ä»¥æŸ¥çœ‹Dockerçš„å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.docker.com/compose/install/</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># docker composeå®‰è£…æ­¥éª¤</span>
 <span class="token function">sudo</span> yum update
 <span class="token function">sudo</span> yum <span class="token function">install</span> docker-compose-plugin
 <span class="token comment"># æŸ¥çœ‹ç‰ˆæœ¬</span>
 <span class="token function">docker</span> compose version
 
 <span class="token function">rpm</span> <span class="token parameter variable">-e</span> <span class="token parameter variable">--nodeps</span> <span class="token variable"><span class="token variable">`</span><span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> docker-compose-plugin<span class="token variable">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Docker Composeå…¥é—¨ç¤ºä¾‹</strong></p><p>Composeçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªdocker-compose.ymlï¼Œç„¶åä½¿ç”¨docker-compose å‘½ä»¤æ“ä½œå³å¯ã€‚docker-compose.ymlæè¿°äº†å®¹å™¨çš„é…ç½®ï¼Œè€Œdocker-compose å‘½ä»¤æè¿°äº†å¯¹å®¹å™¨çš„æ“ä½œã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡ä¸€ä¸ªç¤ºä¾‹å¿«é€Ÿå…¥é—¨ï¼š</p><p>è¿˜è®°å¾—ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬ä½¿ç”¨Dockerfileä¸ºé¡¹ç›®microservice-eureka-serveræ„å»ºDockeré•œåƒå—ï¼Ÿæˆ‘ä»¬è¿˜ä»¥æ­¤é¡¹ç›®ä¸ºä¾‹æµ‹è¯•</p><ul><li>æˆ‘ä»¬åœ¨microservice-eureka-server-0.0.1-SNAPSHOT.jaræ‰€åœ¨ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•ï¼Œåˆ›å»ºdocker-compose.yml æ–‡ä»¶ã€‚</li></ul><p>ç›®å½•æ ‘ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="https://img.jssjqd.cn/202211101632515.png" alt="image-20221110163224784"></p><ul><li>ç„¶ååœ¨docker-compose.yml ä¸­æ·»åŠ å†…å®¹å¦‚ä¸‹ï¼š</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">eureka</span><span class="token punctuation">:</span>             <span class="token comment">#æŒ‡å®šæœåŠ¡å</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>eureka<span class="token punctuation">-</span>server<span class="token punctuation">:</span>0.0.1  <span class="token comment">#æŒ‡å®šé•œåƒåç§°</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./eureka   <span class="token comment">#æŒ‡å®šDockfileæ‰€åœ¨è·¯å¾„</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8761:8761&quot;</span>   <span class="token comment">#æŒ‡å®šç«¯å£æ˜ å°„</span>
    <span class="token key atrule">expose</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token number">8761</span>          <span class="token comment">#å£°æ˜å®¹å™¨å¯¹å¤–æš´éœ²çš„ç«¯å£ </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>åœ¨docker-compose.yml æ‰€åœ¨è·¯å¾„æ‰§è¡Œï¼š</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> compose up ï¼ˆåé¢åŠ -då¯ä»¥åå°å¯åŠ¨ï¼ŒåŠ --buildä¼šé‡æ–°æ„å»ºé•œåƒ<span class="token punctuation">)</span>              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://img.jssjqd.cn/202211101633530.png" alt="image-20221110163340129"></p><p>å¦‚ä¸Šå›¾ï¼Œcomposeå¯åŠ¨ä¼šåšå‡ ä»¶äº‹ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ç½‘ç»œapp_defaultï¼Œé»˜è®¤ä»¥composeæ‰€åœ¨æ–‡ä»¶ç›®å½•ååŠ &quot;_default&quot;å‘½åï¼Œcomposeå†…çš„æ‰€æœ‰å®¹å™¨éƒ½ä¼šåŠ å…¥æ­¤ç½‘ç»œï¼Œå¯ä»¥ç›¸äº’ç”¨æœåŠ¡åè®¿é—®ã€‚</p><p>2ã€å¦‚æœé•œåƒ microservice-eureka-server:0.0.1 ä¸å­˜åœ¨å…ˆæ„å»ºé•œåƒï¼Œå¦‚æœé•œåƒå­˜åœ¨åˆ™ä¸æ„å»ºï¼ŒåŠ ä¸Š --build å‚æ•°å¯ä»¥å¼ºåˆ¶å…ˆæ„å»ºé•œåƒï¼Œå¦‚æœé•œåƒä¹‹å‰æ„å»ºè¿‡ä¸”æ„å»ºæ–‡ä»¶æ²¡æœ‰å˜åŒ–æˆ–æ„å»ºçš„å†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œå°±ç®—åŠ ä¸Š --build å‚æ•°ä¹Ÿä¸ä¼šé‡æ–°æ„å»ºã€‚</p><p>3ã€æ ¹æ®æ„å»ºçš„é•œåƒåˆ›å»ºä¸€ä¸ªåç§°å« app_eureka_1 çš„å®¹å™¨ã€‚</p><p>4ã€å¯åŠ¨å®¹å™¨ã€‚</p><ul><li>è®¿é—®ï¼šhttp://å®¿ä¸»æœºIP:8761/ ï¼Œå‘ç°å¯ä»¥æ­£å¸¸è®¿é—®eurekaä¸»é¡µã€‚</li></ul><p><strong>Docker Composeç®¡ç†å®¹å™¨çš„ç»“æ„</strong></p><p>Docker Composeå°†æ‰€ç®¡ç†çš„å®¹å™¨åˆ†ä¸ºä¸‰å±‚ï¼Œ<strong>åˆ†åˆ«æ˜¯å·¥ç¨‹ï¼ˆ projectï¼‰ï¼ŒæœåŠ¡ï¼ˆserviceï¼‰ä»¥åŠå®¹å™¨ï¼ˆ containerï¼‰</strong>ã€‚ Docker Composeè¿è¡Œç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆ docker-compose.ymlã€ extendsæ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡æ–‡ä»¶ç­‰ï¼‰ç»„æˆä¸€ä¸ªå·¥ç¨‹ï¼ˆé»˜è®¤ä¸º docker-compose.ymlæ‰€åœ¨ç›®å½•çš„ç›®å½•åç§°ï¼‰ã€‚ä¸€ä¸ªå·¥ç¨‹å¯åŒ…å«å¤šä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡ä¸­å®šä¹‰äº†å®¹å™¨è¿è¡Œçš„é•œåƒã€å‚æ•°å’Œä¾èµ–ï¼Œä¸€ä¸ªæœåŠ¡å¯åŒ…æ‹¬å¤šä¸ªå®¹å™¨å®ä¾‹ã€‚</p><p>ä¸ŠèŠ‚ç¤ºä¾‹é‡Œå·¥ç¨‹åç§°æ˜¯ docker-compose.yml æ‰€åœ¨çš„ç›®å½•åã€‚è¯¥å·¥ç¨‹åŒ…å«äº†1ä¸ªæœåŠ¡ï¼ŒæœåŠ¡åç§°æ˜¯ eurekaï¼Œæ‰§è¡Œ docker-compose upæ—¶ï¼Œå¯åŠ¨äº†eurekaæœåŠ¡çš„1ä¸ªå®¹å™¨å®ä¾‹ã€‚</p><p>åŒä¸€ä¸ªdocker composeå†…éƒ¨çš„å®¹å™¨ä¹‹é—´å¯ä»¥ç”¨æœåŠ¡åç›¸äº’è®¿é—®ï¼Œ<strong>æœåŠ¡åå°±ç›¸å½“äºhostnameï¼Œå¯ä»¥ç›´æ¥ ping æœåŠ¡åï¼Œå¾—åˆ°çš„å°±æ˜¯æœåŠ¡å¯¹åº”å®¹å™¨çš„ipï¼Œå¦‚æœæœåŠ¡åšäº†æ‰©å®¹ï¼Œä¸€ä¸ªæœåŠ¡å¯¹åº”äº†å¤šä¸ªå®¹å™¨ï¼Œåˆ™ ping æœåŠ¡å ä¼šè½®è¯¢è®¿é—®æœåŠ¡å¯¹åº”çš„æ¯å°å®¹å™¨ip ï¼Œdockeråº•å±‚ç”¨äº†LVSç­‰æŠ€æœ¯å¸®æˆ‘ä»¬å®ç°è¿™ä¸ªè´Ÿè½½å‡è¡¡</strong>ã€‚</p><p><strong>docker-compose.ymlå¸¸ç”¨æŒ‡ä»¤</strong></p><p><strong>image</strong></p><p>æŒ‡å®šé•œåƒåç§°æˆ–è€…é•œåƒidï¼Œå¦‚æœè¯¥é•œåƒåœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼ŒComposeä¼šå°è¯•pullä¸‹æ¥ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code> image: <span class="token function">java</span>              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>build</strong></p><p>æŒ‡å®šDockerfileæ–‡ä»¶çš„è·¯å¾„ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„ï¼Œä¾‹å¦‚ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>build: ./dir              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨ä»¥æŒ‡å®šDockerfileå’Œå‚æ•°ï¼Œä¾‹å¦‚ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">build</span><span class="token punctuation">:</span>
  <span class="token key atrule">context</span><span class="token punctuation">:</span> ./dir
  <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile<span class="token punctuation">-</span>alternate
  <span class="token key atrule">args</span><span class="token punctuation">:</span>
    <span class="token key atrule">buildno</span><span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>command</strong></p><p>è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>ç¤ºä¾‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>command: bundle <span class="token builtin class-name">exec</span> thin <span class="token parameter variable">-p</span> <span class="token number">3000</span>              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªlistï¼Œç±»ä¼¼äºDockerfileæ€»çš„CMDæŒ‡ä»¤ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>command: <span class="token punctuation">[</span>bundle, exec, thin, -p, <span class="token number">3000</span><span class="token punctuation">]</span>              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>links</strong></p><p>æ˜¾ç¤ºé“¾æ¥åˆ°å…¶ä»–æœåŠ¡ä¸­çš„å®¹å™¨ã€‚å¯ä»¥æŒ‡å®šæœåŠ¡åç§°å’Œé“¾æ¥çš„åˆ«åä½¿ç”¨SERVICE:ALIAS çš„å½¢å¼ï¼Œæˆ–è€…åªæŒ‡å®šæœåŠ¡åç§°ï¼Œç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">web</span><span class="token punctuation">:</span>
  <span class="token key atrule">links</span><span class="token punctuation">:</span>
   <span class="token punctuation">-</span> db
   <span class="token punctuation">-</span> db<span class="token punctuation">:</span>database
   <span class="token punctuation">-</span> redis
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>external_links</strong></p><p>è¡¨ç¤ºé“¾æ¥åˆ°docker-compose.ymlå¤–éƒ¨çš„å®¹å™¨ï¼Œç”šè‡³å¹¶éComposeç®¡ç†çš„å®¹å™¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›æä¾›å…±äº«å®¹å™¨æˆ–å…±åŒæœåŠ¡ã€‚æ ¼å¼è·Ÿlinksç±»ä¼¼ï¼Œç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">external_links</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> redis_1
 <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>mysql
 <span class="token punctuation">-</span> project_db_1<span class="token punctuation">:</span>postgresql          
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ports</strong></p><p>æš´éœ²ç«¯å£ä¿¡æ¯ã€‚ä½¿ç”¨å®¿ä¸»ç«¯å£:å®¹å™¨ç«¯å£çš„æ ¼å¼ï¼Œæˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆæ­¤æ—¶å®¿ä¸»æœºå°†ä¼šéšæœºæŒ‡å®šç«¯å£ï¼‰ï¼Œç±»ä¼¼äºdocker run -p ï¼Œç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">ports</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000-3005&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;8000:8000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;9090-9091:8080-8081&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;49100:22&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:8001:8001&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;127.0.0.1:5000-5010:5000-5010&quot;</span>        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>expose</strong></p><p>æš´éœ²ç«¯å£ï¼Œåªå°†ç«¯å£æš´éœ²ç»™è¿æ¥çš„æœåŠ¡ï¼Œè€Œä¸æš´éœ²ç»™å®¿ä¸»æœºï¼Œç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">expose</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;3000&quot;</span>
 <span class="token punctuation">-</span> <span class="token string">&quot;8000&quot;</span>            
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>volumes</strong></p><p>å·æŒ‚è½½è·¯å¾„è®¾ç½®ã€‚å¯ä»¥è®¾ç½®å®¿ä¸»æœºè·¯å¾„ ï¼ˆHOST:CONTAINERï¼‰ æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ ï¼ˆHOST:CONTAINER:roï¼‰ã€‚ç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token comment"># Just specify a path and let the Engine create a volume</span>
  <span class="token punctuation">-</span> /var/lib/mysql

  <span class="token comment"># Specify an absolute path mapping</span>
  <span class="token punctuation">-</span> /opt/data<span class="token punctuation">:</span>/var/lib/mysql

  <span class="token comment"># Path on the host, relative to the Compose file</span>
  <span class="token punctuation">-</span> ./cache<span class="token punctuation">:</span>/tmp/cache

  <span class="token comment"># User-relative path</span>
  <span class="token punctuation">-</span> ~/configs<span class="token punctuation">:</span>/etc/configs/<span class="token punctuation">:</span>ro

  <span class="token comment"># Named volume</span>
  <span class="token punctuation">-</span> datavolume<span class="token punctuation">:</span>/var/lib/mysql       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>volumes_from</strong></p><p>ä»å¦ä¸€ä¸ªæœåŠ¡æˆ–è€…å®¹å™¨æŒ‚è½½å·ã€‚å¯ä»¥æŒ‡å®šåªè¯»æˆ–è€…å¯è¯»å†™ï¼Œå¦‚æœè®¿é—®æ¨¡å¼æ²¡æœ‰æŒ‡å®šï¼Œåˆ™é»˜è®¤æ˜¯å¯è¯»å†™ã€‚ç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">volumes_from</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> service_name
 <span class="token punctuation">-</span> service_name<span class="token punctuation">:</span>ro
 <span class="token punctuation">-</span> container<span class="token punctuation">:</span>container_name
 <span class="token punctuation">-</span> container<span class="token punctuation">:</span>container_name<span class="token punctuation">:</span>rw      
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>environment</strong></p><p>è®¾ç½®ç¯å¢ƒå˜é‡ã€‚å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–è€…å­—å…¸ä¸¤ç§æ–¹å¼ã€‚åªæœ‰ä¸€ä¸ªkeyçš„ç¯å¢ƒå˜é‡å¯ä»¥åœ¨è¿è¡ŒComposeçš„æœºå™¨ä¸Šæ‰¾åˆ°å¯¹</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token key atrule">RACK_ENV</span><span class="token punctuation">:</span> development
  <span class="token key atrule">SHOW</span><span class="token punctuation">:</span> <span class="token string">&#39;true&#39;</span>
  <span class="token key atrule">SESSION_SECRET</span><span class="token punctuation">:</span>

<span class="token key atrule">environment</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> RACK_ENV=development
  <span class="token punctuation">-</span> SHOW=true
  <span class="token punctuation">-</span> SESSION_SECRET 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>env_file</strong></p><p>ä»æ–‡ä»¶ä¸­è·å–ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä¸ºå•ç‹¬çš„æ–‡ä»¶è·¯å¾„æˆ–åˆ—è¡¨ã€‚å¦‚æœé€šè¿‡ docker-compose -f FILE æŒ‡å®šäº†æ¨¡æ¿æ–‡ä»¶ï¼Œåˆ™ env_file ä¸­è·¯å¾„ä¼šåŸºäºæ¨¡æ¿æ–‡ä»¶è·¯å¾„ã€‚å¦‚æœæœ‰å˜é‡åç§°ä¸ environment æŒ‡ä»¤å†²çªï¼Œåˆ™ä»¥envirment ä¸ºå‡†ã€‚ç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">env_file</span><span class="token punctuation">:</span> .env

<span class="token key atrule">env_file</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> ./common.env
  <span class="token punctuation">-</span> ./apps/web.env
  <span class="token punctuation">-</span> /opt/secrets.env    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>extends</strong></p><p>ç»§æ‰¿å¦ä¸€ä¸ªæœåŠ¡ï¼ŒåŸºäºå·²æœ‰çš„æœåŠ¡è¿›è¡Œæ‰©å±•ã€‚</p><p><strong>net</strong></p><p>è®¾ç½®ç½‘ç»œæ¨¡å¼ã€‚ç¤ºä¾‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>net: &quot;bridge&quot;
net: &quot;host&quot;
net: &quot;none&quot;
net: &quot;container:[service name or container name/id]&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>dns</strong></p><p>é…ç½®dnsæœåŠ¡å™¨ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚ç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">dns</span><span class="token punctuation">:</span> 8.8.8.8
<span class="token key atrule">dns</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> 8.8.8.8
  <span class="token punctuation">-</span> 9.9.9.9
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>dns_search</strong></p><p>é…ç½®DNSçš„æœç´¢åŸŸï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œç¤ºä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">dns_search</span><span class="token punctuation">:</span> example.com
<span class="token key atrule">dns_search</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> dc1.example.com
  <span class="token punctuation">-</span> dc2.example.com              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å…¶ä»–</strong></p><p>docker-compose.yml è¿˜æœ‰å¾ˆå¤šå…¶ä»–å‘½ä»¤ï¼Œè¿™é‡Œä»…æŒ‘é€‰å¸¸ç”¨å‘½ä»¤è¿›è¡Œè®²è§£ï¼Œå…¶å®ƒä¸ä½œèµ˜è¿°ã€‚å¦‚æœæ„Ÿå…´è¶£çš„ï¼Œå¯ä»¥å‚è€ƒdocker-compose.ymlæ–‡ä»¶å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.docker.com/compose/compose-file/</p><p><strong>ç”¨Docker Composeç¼–æ’Spring Cloudç”µå•†é¡¹ç›®å¾®æœåŠ¡</strong></p><p>å¦‚æœå¾®æœåŠ¡è¾ƒå¤šï¼Œåˆ™å¯ä»¥ç”¨docker composeæ¥ç»Ÿä¸€ç¼–æ’ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨docker composeæ¥ç»Ÿä¸€ç¼–æ’ç”µå•†é¡¹ç›®çš„äº”ä¸ªå¾®æœåŠ¡ï¼štulingmall-authcenterï¼Œtulingmall-gatewayï¼Œtulingmall-memberï¼Œtulingmall-orderï¼Œtulingmall-product</p><p><strong>ç¼–æ’ç”µå•†é¡¹ç›®ä¾èµ–ç¯å¢ƒ</strong></p><p>1ã€åˆ›å»ºä¸€ä¸ªç©ºç›®å½•docker-mall</p><p>2ã€åœ¨docker-mallç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç¼–æ’æ–‡ä»¶docker-compose-env.ymlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysql</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">5.7</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> mysql
    <span class="token key atrule">command</span><span class="token punctuation">:</span> mysqld <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4 <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci  <span class="token comment">#è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å¯åŠ¨mysqlå‘½ä»¤</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always  <span class="token comment">#å…³æœºæˆ–è€…é‡å¯æœºå™¨æ—¶ï¼ŒdockeråŒæ—¶é‡å¯å®¹å™¨ï¼Œä¸€èˆ¬mysqlæœåŠ¡å¯ä»¥è¿™ä¹ˆè®¾ç½®ï¼Œä¿æŒæœåŠ¡ä¸€ç›´éƒ½åœ¨</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> root <span class="token comment">#è®¾ç½®rootå¸å·å¯†ç </span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 3306<span class="token punctuation">:</span><span class="token number">3306</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/mysql/data/db<span class="token punctuation">:</span>/var/lib/mysql <span class="token comment">#æ•°æ®æ–‡ä»¶æŒ‚è½½</span>
      <span class="token punctuation">-</span> /mydata/mysql/data/conf<span class="token punctuation">:</span>/etc/mysql/conf.d <span class="token comment">#é…ç½®æ–‡ä»¶æŒ‚è½½</span>
      <span class="token punctuation">-</span> /mydata/mysql/log<span class="token punctuation">:</span>/var/log/mysql <span class="token comment">#æ—¥å¿—æ–‡ä»¶æŒ‚è½½</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>   
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span><span class="token number">5.0</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">command</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server <span class="token punctuation">-</span><span class="token punctuation">-</span>appendonly yes  
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/redis/data<span class="token punctuation">:</span>/data <span class="token comment">#æ•°æ®æ–‡ä»¶æŒ‚è½½</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 6379<span class="token punctuation">:</span><span class="token number">6379</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> rabbitmq<span class="token punctuation">:</span>3.7.25<span class="token punctuation">-</span>management
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rabbitmq
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/rabbitmq/data<span class="token punctuation">:</span>/var/lib/rabbitmq <span class="token comment">#æ•°æ®æ–‡ä»¶æŒ‚è½½</span>
      <span class="token punctuation">-</span> /mydata/rabbitmq/log<span class="token punctuation">:</span>/var/log/rabbitmq <span class="token comment">#æ—¥å¿—æ–‡ä»¶æŒ‚è½½</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 5672<span class="token punctuation">:</span><span class="token number">5672</span>
      <span class="token punctuation">-</span> 15672<span class="token punctuation">:</span><span class="token number">15672</span>
  <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> elasticsearch<span class="token punctuation">:</span>6.4.0
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> elasticsearch
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;cluster.name=elasticsearch&quot;</span> <span class="token comment">#è®¾ç½®é›†ç¾¤åç§°ä¸ºelasticsearch</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token comment">#ä»¥å•ä¸€èŠ‚ç‚¹æ¨¡å¼å¯åŠ¨</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span> <span class="token comment">#è®¾ç½®ä½¿ç”¨jvmå†…å­˜å¤§å°ï¼Œç¨å¾®é…ç½®å¤§ç‚¹ï¼Œä¸ç„¶æœ‰å¯èƒ½å¯åŠ¨ä¸æˆåŠŸ</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/elasticsearch/plugins<span class="token punctuation">:</span>/usr/share/elasticsearch/plugins <span class="token comment">#æ’ä»¶æ–‡ä»¶æŒ‚è½½</span>
      <span class="token punctuation">-</span> /mydata/elasticsearch/data<span class="token punctuation">:</span>/usr/share/elasticsearch/data <span class="token comment">#æ•°æ®æ–‡ä»¶æŒ‚è½½</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 9200<span class="token punctuation">:</span><span class="token number">9200</span>
      <span class="token punctuation">-</span> 9300<span class="token punctuation">:</span><span class="token number">9300</span>
  <span class="token key atrule">kibana</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> kibana<span class="token punctuation">:</span>6.4.0
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> kibana
    <span class="token key atrule">links</span><span class="token punctuation">:</span>  <span class="token comment">#åŒä¸€ä¸ªcomposeæ–‡ä»¶ç®¡ç†çš„æœåŠ¡å¯ä»¥ç›´æ¥ç”¨æœåŠ¡åè®¿é—®ï¼Œå¦‚æœè¦ç»™æœåŠ¡å–åˆ«ååˆ™å¯ä»¥ç”¨linkså®ç°ï¼Œå¦‚ä¸‹é¢çš„eså°±æ˜¯elasticsearchæœåŠ¡çš„åˆ«å</span>
      <span class="token punctuation">-</span> elasticsearch<span class="token punctuation">:</span>es <span class="token comment">#å¯ä»¥ç”¨esè¿™ä¸ªåŸŸåè®¿é—®elasticsearchæœåŠ¡</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elasticsearch <span class="token comment">#kibanaåœ¨elasticsearchå¯åŠ¨ä¹‹åå†å¯åŠ¨</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;elasticsearch.hosts=http://es:9200&quot;</span> <span class="token comment">#è®¾ç½®è®¿é—®elasticsearchçš„åœ°å€</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 5601<span class="token punctuation">:</span><span class="token number">5601</span>
  <span class="token key atrule">logstash</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> logstash<span class="token punctuation">:</span>6.4.0
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> logstash
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/logstash/logstash<span class="token punctuation">-</span>springboot.conf<span class="token punctuation">:</span>/usr/share/logstash/pipeline/logstash.conf <span class="token comment">#æŒ‚è½½logstashçš„é…ç½®æ–‡ä»¶ï¼Œdockerå¯¹å•ä¸ªæ–‡ä»¶çš„æŒ‚è½½éœ€è¦å…ˆåœ¨å®¿ä¸»æœºå»ºå¥½å¯¹åº”æ–‡ä»¶æ‰èƒ½æŒ‚è½½æˆåŠŸ</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elasticsearch <span class="token comment">#kibanaåœ¨elasticsearchå¯åŠ¨ä¹‹åå†å¯åŠ¨</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> elasticsearch<span class="token punctuation">:</span>es <span class="token comment">#å¯ä»¥ç”¨esè¿™ä¸ªåŸŸåè®¿é—®elasticsearchæœåŠ¡</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 4560<span class="token punctuation">:</span><span class="token number">4560</span>
  <span class="token key atrule">mongo</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span><span class="token number">3.2</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> mongo
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/mongo/db<span class="token punctuation">:</span>/data/db <span class="token comment">#æ•°æ®æ–‡ä»¶æŒ‚è½½</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 27017<span class="token punctuation">:</span><span class="token number">27017</span>
  <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nacos/nacos<span class="token punctuation">-</span>server<span class="token punctuation">:</span>1.4.2
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> nacos
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> MODE=standalone
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/nacos/logs/<span class="token punctuation">:</span>/home/nacos/logs
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8848:8848&quot;</span>
  <span class="token key atrule">zookeeper</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span><span class="token number">3.5</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 2181<span class="token punctuation">:</span><span class="token number">2181</span> 
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/zookeeper/data<span class="token punctuation">:</span>/data
      <span class="token punctuation">-</span> /mydata/zookeeper/conf<span class="token punctuation">:</span>/conf
      
  <span class="token key atrule">rocketmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> rocketmqinc/rocketmq
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rocketmq
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 9876<span class="token punctuation">:</span><span class="token number">9876</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/rocketmq/logs<span class="token punctuation">:</span>/home/rocketmq/logs
      <span class="token punctuation">-</span> /mydata/rocketmq/store<span class="token punctuation">:</span>/home/rocketmq/store
    <span class="token key atrule">command</span><span class="token punctuation">:</span> sh mqnamesrv
  <span class="token key atrule">broker</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> rocketmqinc/rocketmq
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rmqbroker
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 10909<span class="token punctuation">:</span><span class="token number">10909</span>
      <span class="token punctuation">-</span> 10911<span class="token punctuation">:</span><span class="token number">10911</span>
      <span class="token punctuation">-</span> 10912<span class="token punctuation">:</span><span class="token number">10912</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /mydata/rocketmq/logs<span class="token punctuation">:</span>/home/rocketmq/logs
      <span class="token punctuation">-</span> /mydata/rocketmq/store<span class="token punctuation">:</span>/home/rocketmq/store
      <span class="token punctuation">-</span> /mydata/rocketmq/conf/broker.conf<span class="token punctuation">:</span>/opt/rocketmq<span class="token punctuation">-</span>4.4.0/conf/broker.conf  <span class="token comment">#è¿™ä¸ªé…ç½®éœ€è¦å…ˆåœ¨å®¿ä¸»æœºå¯¹åº”ç›®å½•æ”¾å¥½broker.confé…ç½®æ–‡ä»¶,æ–‡ä»¶å†…å®¹å‚è€ƒä¸‹é¢æ–‡æ¡£</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> sh mqbroker <span class="token punctuation">-</span>n namesrv<span class="token punctuation">:</span>9876 <span class="token punctuation">-</span>c ../conf/broker.conf
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> rocketmq
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_HOME=/usr/lib/jvm/jre
  <span class="token key atrule">console</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> styletang/rocketmq<span class="token punctuation">-</span>console<span class="token punctuation">-</span>ng
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rocketmq<span class="token punctuation">-</span>console<span class="token punctuation">-</span>ng
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8076<span class="token punctuation">:</span><span class="token number">8080</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> rocketmq
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_OPTS= <span class="token punctuation">-</span>Dlogging.level.root=info <span class="token punctuation">-</span>Drocketmq.namesrv.addr=rocketmq<span class="token punctuation">:</span><span class="token number">9876</span> 
      <span class="token punctuation">-</span> Dcom.rocketmq.sendMessageWithVIPChannel=false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>broker.confæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">brokerName</span> <span class="token punctuation">=</span> <span class="token value attr-value">broker-a</span>
<span class="token key attr-name">brokerId</span> <span class="token punctuation">=</span> <span class="token value attr-value">0</span>
<span class="token key attr-name">deleteWhen</span> <span class="token punctuation">=</span> <span class="token value attr-value">04</span>
<span class="token key attr-name">fileReservedTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">48</span>
<span class="token key attr-name">brokerRole</span> <span class="token punctuation">=</span> <span class="token value attr-value">ASYNC_MASTER</span>
<span class="token key attr-name">flushDiskType</span> <span class="token punctuation">=</span> <span class="token value attr-value">ASYNC_FLUSH</span>
<span class="token comment"># å®¿ä¸»æœºIP</span>
<span class="token key attr-name">brokerIP1</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.65.42   </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€å¯åŠ¨composeæ‰€æœ‰å®¹å™¨ï¼Œåœ¨docker-mallç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-env.yml up <span class="token parameter variable">-d</span>              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¸¸ç”¨çš„ä¸€äº›docker-composeå‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹composeå†…çš„å®¹å™¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml <span class="token function">ps</span>
<span class="token comment"># å…³é—­æˆ–å¯åŠ¨æˆ–é‡å¯composeå†…çš„æŸä¸ªå®¹å™¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml stop/start/restart <span class="token operator">&lt;</span>æœåŠ¡å<span class="token operator">&gt;</span>
<span class="token comment"># å…³é—­æˆ–é‡å¯composeæ‰€æœ‰å®¹å™¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml stop/restart
<span class="token comment"># æŸ¥çœ‹composeæ‰€æœ‰å®¹å™¨çš„è¿è¡Œæ—¥å¿—</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml logs <span class="token parameter variable">-f</span>
<span class="token comment"># æŸ¥çœ‹composeä¸‹æŸä¸ªå®¹å™¨çš„è¿è¡Œæ—¥å¿—</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml logs <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span>æœåŠ¡å<span class="token operator">&gt;</span>
<span class="token comment"># ä¹Ÿå¯ä»¥æŠŠcomposeçš„å®¹å™¨æ—¥å¿—è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶é‡Œå»ï¼Œç„¶åç”¨tail -f éšæ—¶æŸ¥çœ‹</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml logs <span class="token parameter variable">-f</span> <span class="token operator">&gt;&gt;</span> myDockerCompose.log <span class="token operator">&amp;</span>
<span class="token comment"># é‡æ–°æ„å»ºæœ‰å˜åŒ–çš„é•œåƒå¹¶æ›´æ–°åˆ°å®¹å™¨å†å¯åŠ¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml up <span class="token parameter variable">--build</span> <span class="token parameter variable">-d</span>
<span class="token comment"># é‡æ–°åˆ›å»ºdocker-compose.ymlé…ç½®æœ‰å˜åŒ–çš„å®¹å™¨å¹¶å¯åŠ¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml up --force-recreate <span class="token parameter variable">-d</span>
<span class="token comment">#åœæ‰å®¹å™¨å†åˆ é™¤å®¹å™¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml down        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¼–æ’ç”µå•†å¾®æœåŠ¡</strong></p><p>1ã€åœ¨docker-mallç›®å½•ä¸‹åˆ†åˆ«åˆ›å»ºtulingmall-authcenterï¼Œtulingmall-gatewayï¼Œtulingmall-memberï¼Œtulingmall-orderï¼Œtulingmall-productç›®å½•ã€‚</p><p>2ã€ä¿®æ”¹ç”µå•†é¡¹ç›®ä¸Šé¢è¿™å‡ ä¸ªå¾®æœåŠ¡é…ç½®æ–‡ä»¶é‡Œçš„ä¸­é—´ä»¶é…ç½®ä¸ºä¸Šé¢docker composeé‡Œçš„æœåŠ¡åï¼Œå¹¶æ‰“å¥½jaråŒ…æ”¾å…¥ä¸Šé¢å¯¹åº”çš„æ–‡ä»¶å¤¹ã€‚</p><p>ä»¥tulingmall-productæœåŠ¡ä¸ºä¾‹ï¼Œå¯¹åº”ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶å¦‚ä¸‹(æ³¨æ„ï¼šå¤§å®¶æŒ‰ç…§è‡ªå·±ä¸‹è½½é¡¹ç›®çš„é…ç½®æ–‡ä»¶å»ä¿®æ”¹ï¼Œä¸è¦ç›´æ¥ç”¨æˆ‘è¿™é‡Œçš„é…ç½®ï¼Œæœ‰å¯èƒ½ç‰ˆæœ¬ä¸å¯¹)</p><p>bootstrap.ymlæ–‡ä»¶é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>product
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> nacos<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#é…ç½®ä¸­å¿ƒçš„åœ°å€</span>
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yml <span class="token comment">#é…ç½®æ–‡ä»¶ç»“å°¾çš„é…ç½®</span>
        <span class="token key atrule">shared-dataids</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>nacos.yml<span class="token punctuation">,</span>tulingmall<span class="token punctuation">-</span>db<span class="token punctuation">-</span>common.yml <span class="token comment">#å›¾çµå•†åŸå…¬å…±é…ç½®</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>tulingmall-product-dev.ymlæ–‡ä»¶é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8866</span>
  <span class="token key atrule">tomcat</span><span class="token punctuation">:</span>
    <span class="token key atrule">max-threads</span><span class="token punctuation">:</span> <span class="token number">100</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>product
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span>  <span class="token comment">#å¯†ç </span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 5000ms
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">50</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>1ms
        <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">8</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">0</span>
        
<span class="token key atrule">management</span><span class="token punctuation">:</span> <span class="token comment">#å¼€å¯SpringBoot Adminçš„ç›‘æ§</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
  <span class="token key atrule">endpoint</span><span class="token punctuation">:</span>
    <span class="token key atrule">health</span><span class="token punctuation">:</span>
      <span class="token key atrule">show-details</span><span class="token punctuation">:</span> always

<span class="token key atrule">seata</span><span class="token punctuation">:</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> nacos<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos
  <span class="token key atrule">registry</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos
  <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> my_test_tx_group
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">support</span><span class="token punctuation">:</span>
      <span class="token key atrule">spring</span><span class="token punctuation">:</span>
        <span class="token key atrule">datasource-autoproxy</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

<span class="token comment">#zké…ç½®</span>
<span class="token key atrule">zk</span><span class="token punctuation">:</span>
  <span class="token key atrule">curator</span><span class="token punctuation">:</span>
    <span class="token key atrule">retryCount</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment">#é‡è¯•æ¬¡æ•°</span>
    <span class="token key atrule">elapsedTimeMs</span><span class="token punctuation">:</span> <span class="token number">5000</span> <span class="token comment">#</span>
    <span class="token key atrule">connectUrl</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span><span class="token number">2181</span> <span class="token comment">#zkåœ°å€</span>
    <span class="token key atrule">sessionTimeOutMs</span><span class="token punctuation">:</span> <span class="token number">60000</span> <span class="token comment">#ä¼šè¯è¶…æ—¶æ—¶é—´</span>
    <span class="token key atrule">connectionTimeOutMs</span><span class="token punctuation">:</span> <span class="token number">5000</span> <span class="token comment">#è¿æ¥è¶…æ—¶æ—¶é—´        </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>tulingmall-nacos.ymlæ–‡ä»¶é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> nacos<span class="token punctuation">:</span><span class="token number">8848</span>      
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>tulingmall-db-common.ymlæ–‡ä»¶é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//db<span class="token punctuation">:</span>3306/micromall<span class="token punctuation">?</span>serverTimezone=UTC<span class="token important">&amp;useSSL=false&amp;useUnicode=true&amp;characterEncoding=UTF-</span><span class="token number">8</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
    <span class="token key atrule">druid</span><span class="token punctuation">:</span>
      <span class="token key atrule">initial-size</span><span class="token punctuation">:</span> <span class="token number">5</span> <span class="token comment">#è¿æ¥æ± åˆå§‹åŒ–å¤§å°</span>
      <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">10</span> <span class="token comment">#æœ€å°ç©ºé—²è¿æ¥æ•°</span>
      <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">20</span> <span class="token comment">#æœ€å¤§è¿æ¥æ•°</span>
      <span class="token key atrule">web-stat-filter</span><span class="token punctuation">:</span>
        <span class="token key atrule">exclusions</span><span class="token punctuation">:</span> <span class="token string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*&quot;</span> <span class="token comment">#ä¸ç»Ÿè®¡è¿™äº›è¯·æ±‚æ•°æ®</span>
      <span class="token key atrule">stat-view-servlet</span><span class="token punctuation">:</span> <span class="token comment">#è®¿é—®ç›‘æ§ç½‘é¡µçš„ç™»å½•ç”¨æˆ·åå’Œå¯†ç </span>
        <span class="token key atrule">login-username</span><span class="token punctuation">:</span> druid
        <span class="token key atrule">login-password</span><span class="token punctuation">:</span> druid
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> classpath<span class="token punctuation">:</span>dao/<span class="token important">*.xml</span>
    <span class="token punctuation">-</span> classpath<span class="token important">*:com/**/mapper/*.xml</span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€åœ¨æ¯ä¸ªå¾®æœåŠ¡ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªDockerfileï¼Œå†…å®¹å¦‚ä¸‹ï¼Œä»¥tulingmall-productæœåŠ¡ä¸ºä¾‹ï¼Œå…¶å®ƒå¾®æœåŠ¡éƒ½ç±»ä¼¼ä¿®æ”¹ï¼š</p><div class="language-docker line-numbers-mode" data-ext="docker" data-title="docker"><pre class="language-docker"><code><span class="token comment"># åŸºäºå“ªä¸ªé•œåƒ</span>
<span class="token instruction"><span class="token keyword">From</span> java:8</span>
<span class="token comment"># å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨</span>
<span class="token instruction"><span class="token keyword">ADD</span> tulingmall-product-0.0.1-SNAPSHOT.jar /app.jar</span>
<span class="token comment"># é…ç½®å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å‘½ä»¤</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;java&quot;</span>,<span class="token string">&quot;-jar&quot;</span>,<span class="token string">&quot;/app.jar&quot;</span>]  </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹</p><p>4ã€åœ¨docker-mallç›®å½•ä¸‹æ–°å»ºå¾®æœåŠ¡ç¼–æ’æ–‡ä»¶docker-compose-app.ymlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-docker line-numbers-mode" data-ext="docker" data-title="docker"><pre class="language-docker"><code>version: &#39;3.8&#39;
services:
  tulingmall-authcenter:
    image: mall/tulingmall-authcenter:0.0.1  #æŒ‡å®šé•œåƒåç§°
    build: ./tulingmall-authcenter  #æŒ‡å®šDockfileæ‰€åœ¨è·¯å¾„
    container_name: tulingmall-authcenter  #æŒ‡å®šå¯åŠ¨å®¹å™¨åç§°
    ports:
      - 9999:9999
    volumes:
      - /etc/localtime:/etc/localtime:ro  #åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´ï¼Œroä»£è¡¨readonlyåªè¯»
    environment:
      - JAVA_TOOL_OPTIONS=-Xmx1g -Xms1g -XX:MaxMetaspaceSize=512m -javaagent:/agent/skywalking-agent.jar -DSW_AGENT_NAME=tulingmall-order -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204:11800
    external_links:  #è®¿é—®ä¸åœ¨åŒä¸€ä¸ªcomposeæ–‡ä»¶ç®¡ç†çš„æœåŠ¡éœ€è¦ç”¨external_linksï¼Œå‰ææ˜¯è¿™äº›æœåŠ¡éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹æ‰èƒ½æ­£å¸¸è®¿é—® 
      - nacos:nacos  #å¯ä»¥ç”¨nacosè¿™ä¸ªåŸŸåè®¿é—®nacosæœåŠ¡
      - mysql:db  #å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡
    cap_add:
      - SYS_PTRACE #è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ 
  tulingmall-gateway:
    image: mall/tulingmall-gateway:0.0.1
    build: ./tulingmall-gateway
    container_name: tulingmall-gateway
    ports:
      - 8888:8888
    volumes:
      - /etc/localtime:/etc/localtime:ro #åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´
    environment:
      - JAVA_TOOL_OPTIONS=-Xmx1g -Xms1g -XX:MaxMetaspaceSize=512m -javaagent:/agent/skywalking-agent.jar -DSW_AGENT_NAME=tulingmall-order -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204:11800
    depends_on:
      - tulingmall-authcenter #gatewayåœ¨authcenterå¯åŠ¨ä¹‹åå†å¯åŠ¨
    external_links:
      - nacos:nacos
    cap_add:
      - SYS_PTRACE #è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ 
  tulingmall-member:
    image: mall/tulingmall-member:0.0.1
    build: ./tulingmall-member
    container_name: tulingmall-member
    ports:
      - 8877:8877
    volumes:
      - /etc/localtime:/etc/localtime:ro #åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´
    environment:
      - JAVA_TOOL_OPTIONS=-Xmx1g -Xms1g -XX:MaxMetaspaceSize=512m -javaagent:/agent/skywalking-agent.jar -DSW_AGENT_NAME=tulingmall-order -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204:11800
    external_links:
      - nacos:nacos
      - mysql:db #å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡
      - mongo
      - redis
      - rabbitmq
    cap_add:
      - SYS_PTRACE #è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ 
  tulingmall-product:
    image: mall/tulingmall-product:0.0.1
    build: ./tulingmall-product
    container_name: tulingmall-product
    ports:
      - 8866:8866
    volumes:
      - /etc/localtime:/etc/localtime:ro #åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´
    environment:
      - JAVA_TOOL_OPTIONS=-Xmx1g -Xms1g -XX:MaxMetaspaceSize=512m -javaagent:/agent/skywalking-agent.jar -DSW_AGENT_NAME=tulingmall-order -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204:11800
    external_links:
      - nacos:nacos
      - mysql:db #å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡
      - redis
      - zookeeper
    cap_add:
      - SYS_PTRACE #è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ 
  tulingmall-order:
    image: mall/tulingmall-order:0.0.1
    build: ./tulingmall-order
    container_name: tulingmall-order
    ports:
      - 8844:8844
    volumes:
      - /etc/localtime:/etc/localtime:ro #åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´
    environment:
      - JAVA_TOOL_OPTIONS=-Xmx1g -Xms1g -XX:MaxMetaspaceSize=512m -javaagent:/agent/skywalking-agent.jar -DSW_AGENT_NAME=tulingmall-order -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204:11800
    external_links:
      - nacos:nacos
      - mysql:db #å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡
      - redis
      - rabbitmq
      - namesrv:rockermq
    cap_add:
      - SYS_PTRACE #è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ           
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5ã€å¯åŠ¨composeçš„æ‰€æœ‰å¾®æœåŠ¡å®¹å™¨ï¼Œåœ¨docker-mallç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#è¿™é‡Œå¯åŠ¨çš„å¾®æœåŠ¡è·Ÿä¸Šé¢å¯åŠ¨çš„mysqlï¼Œredisè¿™äº›ä¸­é—´ä»¶æœåŠ¡å› ä¸ºéƒ½åœ¨docker-mallç›®å½•ä¸‹ï¼Œå³éƒ½æ˜¯åŒä¸€ä¸ªå·¥ç¨‹ä¸‹ï¼Œé»˜è®¤éƒ½åœ¨ç›¸åŒçš„ç½‘ç»œä¸‹ï¼Œå¯ä»¥ç›¸äº’è®¿é—®</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml up <span class="token parameter variable">-d</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>6ã€è®¿é—®ä¸‹å¾®æœåŠ¡çš„apiçœ‹æ˜¯å¦éƒ½æ­£å¸¸ï¼Œè®¿é—®æ¥å£å‚æ•°å‚çœ‹è§†é¢‘ï¼Œä¸ä¸€å®šè®¿é—®æˆ‘åˆ—çš„è¿™å‡ ä¸ªæ¥å£ï¼Œå…¶å®ƒçš„æ¥å£ä¹Ÿè¡Œ</p><div class="language-ba line-numbers-mode" data-ext="ba" data-title="ba"><pre class="language-ba"><code>1ã€é€šè¿‡ç½‘å…³è®¿é—®ç™»å½•æ¥å£è·å–tokenï¼Œpostæ–¹å¼ï¼š
http://192.168.65.61:8888/sso/login?username=test&amp;password=test  
2ã€é€šè¿‡ç½‘å…³è®¿é—®æ·»åŠ è´­ç‰©è½¦æ¥å£ï¼Œpostæ–¹å¼ï¼š
http://192.168.65.61:8888/cart/add
3ã€é€šè¿‡ç½‘å…³è®¿é—®æŸ¥è¯¢è´­ç‰©è½¦æ¥å£ï¼Œgetæ–¹å¼ï¼š
http://192.168.65.61:8888/cart/list
4ã€é€šè¿‡ç½‘å…³è®¿é—®åˆ›å»ºè®¢å•æ¥å£ï¼Œpostæ–¹å¼ï¼š
http://192.168.65.61:8888/order/generateOrder   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åŠ¨æ€æ‰©å®¹å¾®æœåŠ¡(å•ç‰©ç†æœºå†…æ‰©å®¹)</strong></p><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦æ‰©å®¹å¾®æœåŠ¡ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³æŠŠç”¨æˆ·å’Œè®¢å•å¾®æœåŠ¡å„éƒ¨ç½²ä¸¤ä¸ªå¾®æœåŠ¡ï¼Œåˆ™éœ€è¦å°†docker-compose.ymlé‡Œçš„æœåŠ¡çš„ç«¯å£æ˜ å°„å’Œå®¹å™¨åç§°éƒ½æ³¨é‡Šæ‰ï¼Œå› ä¸ºä¸å¯èƒ½ä¸¤ä¸ªè®¢å•æœåŠ¡çš„å®¹å™¨æ˜ å°„åˆ°å®¿ä¸»æœºçš„åŒä¸€ä¸ªç«¯å£ï¼Œä¿®æ”¹ä¹‹åçš„docker-compose-app.ymlå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">tulingmall-authcenter</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mall/tulingmall<span class="token punctuation">-</span>authcenter<span class="token punctuation">:</span>0.0.1  <span class="token comment">#æŒ‡å®šé•œåƒåç§°</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./tulingmall<span class="token punctuation">-</span>authcenter  <span class="token comment">#æŒ‡å®šDockfileæ‰€åœ¨è·¯å¾„</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>authcenter  <span class="token comment">#æŒ‡å®šå¯åŠ¨å®¹å™¨åç§°</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 9999<span class="token punctuation">:</span><span class="token number">9999</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /etc/localtime<span class="token punctuation">:</span>/etc/localtime<span class="token punctuation">:</span>ro  <span class="token comment">#åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´ï¼Œroä»£è¡¨readonlyåªè¯»</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_TOOL_OPTIONS=<span class="token punctuation">-</span>Xmx1g <span class="token punctuation">-</span>Xms1g <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>MaxMetaspaceSize=256m <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/agent/skywalking<span class="token punctuation">-</span>agent.jar <span class="token punctuation">-</span>DSW_AGENT_NAME=tulingmall<span class="token punctuation">-</span>order <span class="token punctuation">-</span>DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204<span class="token punctuation">:</span><span class="token number">11800</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>  <span class="token comment">#è®¿é—®ä¸åœ¨åŒä¸€ä¸ªcomposeæ–‡ä»¶ç®¡ç†çš„æœåŠ¡éœ€è¦ç”¨external_linksï¼Œå‰ææ˜¯è¿™äº›æœåŠ¡éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹æ‰èƒ½æ­£å¸¸è®¿é—® </span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>nacos  <span class="token comment">#å¯ä»¥ç”¨nacosè¿™ä¸ªåŸŸåè®¿é—®nacosæœåŠ¡</span>
      <span class="token punctuation">-</span> mysql<span class="token punctuation">:</span>db  <span class="token comment">#å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡</span>
    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> SYS_PTRACE <span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ </span>
  <span class="token key atrule">tulingmall-gateway</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mall/tulingmall<span class="token punctuation">-</span>gateway<span class="token punctuation">:</span>0.0.1
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./tulingmall<span class="token punctuation">-</span>gateway
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>gateway
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8888<span class="token punctuation">:</span><span class="token number">8888</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /etc/localtime<span class="token punctuation">:</span>/etc/localtime<span class="token punctuation">:</span>ro <span class="token comment">#åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_TOOL_OPTIONS=<span class="token punctuation">-</span>Xmx1g <span class="token punctuation">-</span>Xms1g <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>MaxMetaspaceSize=256m <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/agent/skywalking<span class="token punctuation">-</span>agent.jar <span class="token punctuation">-</span>DSW_AGENT_NAME=tulingmall<span class="token punctuation">-</span>order <span class="token punctuation">-</span>DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204<span class="token punctuation">:</span><span class="token number">11800</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> tulingmall<span class="token punctuation">-</span>authcenter <span class="token comment">#gatewayåœ¨authcenterå¯åŠ¨ä¹‹åå†å¯åŠ¨</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>nacos
    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> SYS_PTRACE <span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ </span>
  <span class="token key atrule">tulingmall-member</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mall/tulingmall<span class="token punctuation">-</span>member<span class="token punctuation">:</span>0.0.1
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./tulingmall<span class="token punctuation">-</span>member
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> tulingmall<span class="token punctuation">-</span>member
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8877<span class="token punctuation">:</span><span class="token number">8877</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /etc/localtime<span class="token punctuation">:</span>/etc/localtime<span class="token punctuation">:</span>ro <span class="token comment">#åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_TOOL_OPTIONS=<span class="token punctuation">-</span>Xmx1g <span class="token punctuation">-</span>Xms1g <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>MaxMetaspaceSize=256m <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/agent/skywalking<span class="token punctuation">-</span>agent.jar <span class="token punctuation">-</span>DSW_AGENT_NAME=tulingmall<span class="token punctuation">-</span>order <span class="token punctuation">-</span>DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204<span class="token punctuation">:</span><span class="token number">11800</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>nacos
      <span class="token punctuation">-</span> mysql<span class="token punctuation">:</span>db <span class="token comment">#å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡</span>
      <span class="token punctuation">-</span> mongo
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> rabbitmq
    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> SYS_PTRACE <span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ </span>
  <span class="token key atrule">tulingmall-product</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mall/tulingmall<span class="token punctuation">-</span>product<span class="token punctuation">:</span>0.0.1
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./tulingmall<span class="token punctuation">-</span>product
<span class="token comment">#    container_name: tulingmall-product</span>
<span class="token comment">#    ports:</span>
<span class="token comment">#      - 8866:8866</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /etc/localtime<span class="token punctuation">:</span>/etc/localtime<span class="token punctuation">:</span>ro <span class="token comment">#åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_TOOL_OPTIONS=<span class="token punctuation">-</span>Xmx1g <span class="token punctuation">-</span>Xms1g <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>MaxMetaspaceSize=256m <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/agent/skywalking<span class="token punctuation">-</span>agent.jar <span class="token punctuation">-</span>DSW_AGENT_NAME=tulingmall<span class="token punctuation">-</span>order <span class="token punctuation">-</span>DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204<span class="token punctuation">:</span><span class="token number">11800</span>
    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
      replicas<span class="token punctuation">:</span><span class="token number">2</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>nacos
      <span class="token punctuation">-</span> mysql<span class="token punctuation">:</span>db <span class="token comment">#å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> zookeeper
    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> SYS_PTRACE <span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ </span>
  <span class="token key atrule">tulingmall-order</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mall/tulingmall<span class="token punctuation">-</span>order<span class="token punctuation">:</span>0.0.1
    <span class="token key atrule">build</span><span class="token punctuation">:</span> ./tulingmall<span class="token punctuation">-</span>order
<span class="token comment">#    container_name: tulingmall-order</span>
<span class="token comment">#    ports:</span>
<span class="token comment">#      - 8844:8844</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /etc/localtime<span class="token punctuation">:</span>/etc/localtime<span class="token punctuation">:</span>ro <span class="token comment">#åŒæ­¥å®¿ä¸»æœºä¸å®¹å™¨æ—¶é—´</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> JAVA_TOOL_OPTIONS=<span class="token punctuation">-</span>Xmx1g <span class="token punctuation">-</span>Xms1g <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>MaxMetaspaceSize=256m <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/agent/skywalking<span class="token punctuation">-</span>agent.jar <span class="token punctuation">-</span>DSW_AGENT_NAME=tulingmall<span class="token punctuation">-</span>order <span class="token punctuation">-</span>DSW_AGENT_COLLECTOR_BACKEND_SERVICES=192.168.65.204<span class="token punctuation">:</span><span class="token number">11800</span>
    <span class="token key atrule">external_links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>nacos
      <span class="token punctuation">-</span> mysql<span class="token punctuation">:</span>db <span class="token comment">#å¯ä»¥ç”¨dbè¿™ä¸ªåŸŸåè®¿é—®mysqlæœåŠ¡</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> rabbitmq
      <span class="token punctuation">-</span> namesrv<span class="token punctuation">:</span>rockermq
    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> SYS_PTRACE <span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯è®©dockerèƒ½æ”¯æŒåœ¨å®¹å™¨é‡Œèƒ½æ‰§è¡Œjdkè‡ªå¸¦çš„ç±»ä¼¼jinfoï¼Œjmapè¿™äº›å‘½ä»¤ï¼Œå¦‚æœä¸éœ€è¦åœ¨å®¹å™¨é‡Œæ‰§è¡Œè¿™äº›å‘½ä»¤å¯ä»¥ä¸åŠ </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œå¦‚ä¸‹æ‰©å®¹å‘½ä»¤ï¼Œ<strong>æœåŠ¡ä¸€æ—¦æ‰©å®¹å¯¹åº”äº†å¤šä¸ªå®¹å™¨ï¼Œåˆ™è®¿é—®æœåŠ¡ådockerä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è´Ÿè½½å‡è¡¡å»è®¿é—®æœåŠ¡å¯¹åº”çš„æ¯å°å®¹å™¨</strong>ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml up --force-recreate <span class="token parameter variable">-d</span>     <span class="token comment">#å¿…é¡»å…ˆæ­£å¸¸ç¼–æ’å¾®æœåŠ¡ï¼Œç„¶åæ‰èƒ½åŠ¨æ€æ‰©å®¹,æ–‡ä»¶æœ‰å˜åŠ¨ï¼Œéœ€è¦é‡æ–°åˆ›å»ºå®¹å™¨</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml scale tulingmall-order<span class="token operator">=</span><span class="token number">2</span> tulingmall-product<span class="token operator">=</span><span class="token number">2</span>   
<span class="token comment">#å¦‚æœè¦ç¼©å®¹æ‰§è¡Œå¦‚ä¸‹æ“ä½œ</span>
<span class="token function">docker</span> compose <span class="token parameter variable">-f</span> docker-compose-app.yml scale tulingmall-order<span class="token operator">=</span><span class="token number">1</span> tulingmall-product<span class="token operator">=</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šdocker composeä¸»è¦ç”¨åœ¨å•ç‰©ç†æœºå†…æ‰©å®¹çš„æƒ…å†µï¼Œè¦åšå¤šæœºæ‰©å®¹è¿˜éœ€è‡ªå·±åœ¨å¤šä¸ªæœºå™¨ä¸Šåšå¾ˆå¤šå®šåˆ¶åŒ–é…ç½®ï¼Œå½“ç„¶ï¼Œè¦åšå¤šç‰©ç†æœºæ‰©å®¹ä¸€èˆ¬éƒ½ä¼šç”¨docker swarmæˆ–kubernetesã€‚</p></div><!--[--><!----><!--]--><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: thejqd@gmail.com">jiangqingdong</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link nav-link next" href="/pages/01dad9/" aria-label="Dockerfile"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Dockerfile<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CT4bPn0M.js" defer></script>
  </body>
</html>
