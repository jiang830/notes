<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.26" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <title>Nacosé…ç½®ä¸­å¿ƒ</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-CV-aSyL0.css" as="style"><link rel="stylesheet" href="/assets/style-CV-aSyL0.css">
    <link rel="modulepreload" href="/assets/app-CT4bPn0M.js"><link rel="modulepreload" href="/assets/index.html-CHbiAsYT.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-CSpmhHeK.js" as="script"><link rel="prefetch" href="/assets/index.html--2R5vsdh.js" as="script"><link rel="prefetch" href="/assets/index.html-BnXtwsXL.js" as="script"><link rel="prefetch" href="/assets/index.html-B7hYqSw6.js" as="script"><link rel="prefetch" href="/assets/index.html-DUyfniXY.js" as="script"><link rel="prefetch" href="/assets/index.html-BKnH3ub0.js" as="script"><link rel="prefetch" href="/assets/index.html-BGvXNw7H.js" as="script"><link rel="prefetch" href="/assets/index.html-DKvIwItS.js" as="script"><link rel="prefetch" href="/assets/index.html-BLFHdWAv.js" as="script"><link rel="prefetch" href="/assets/é˜¿é‡Œäº‘é¢è¯•é¢˜.html-67Gclmd5.js" as="script"><link rel="prefetch" href="/assets/index.html-Coth3iwF.js" as="script"><link rel="prefetch" href="/assets/index.html-DL1BW0Yy.js" as="script"><link rel="prefetch" href="/assets/index.html-Cv7ToGV2.js" as="script"><link rel="prefetch" href="/assets/index.html-CiOSF6nN.js" as="script"><link rel="prefetch" href="/assets/index.html-wgNrMjyX.js" as="script"><link rel="prefetch" href="/assets/index.html-DMtMjVx-.js" as="script"><link rel="prefetch" href="/assets/index.html-D7jwlDKQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CU5_oyTi.js" as="script"><link rel="prefetch" href="/assets/index.html-Bq6U-nqM.js" as="script"><link rel="prefetch" href="/assets/index.html-BxoJLgxp.js" as="script"><link rel="prefetch" href="/assets/index.html-B04c0mD5.js" as="script"><link rel="prefetch" href="/assets/index.html-gaD97CLH.js" as="script"><link rel="prefetch" href="/assets/index.html-nv6Kc-Od.js" as="script"><link rel="prefetch" href="/assets/index.html-OXo_SpP2.js" as="script"><link rel="prefetch" href="/assets/index.html-DGBnV6QP.js" as="script"><link rel="prefetch" href="/assets/index.html-DRfvV7TW.js" as="script"><link rel="prefetch" href="/assets/index.html-4TFYILmP.js" as="script"><link rel="prefetch" href="/assets/index.html-CGfXoegH.js" as="script"><link rel="prefetch" href="/assets/index.html-DMW40kv2.js" as="script"><link rel="prefetch" href="/assets/index.html-BLfh2K27.js" as="script"><link rel="prefetch" href="/assets/index.html-FnU2NHSk.js" as="script"><link rel="prefetch" href="/assets/index.html-CVyeJ0nv.js" as="script"><link rel="prefetch" href="/assets/index.html-CtS7Hbk_.js" as="script"><link rel="prefetch" href="/assets/index.html-CS-yKKXA.js" as="script"><link rel="prefetch" href="/assets/index.html-g5I17pEN.js" as="script"><link rel="prefetch" href="/assets/index.html-pNX6YByX.js" as="script"><link rel="prefetch" href="/assets/index.html-WBck0DLr.js" as="script"><link rel="prefetch" href="/assets/index.html-R6fBvdOR.js" as="script"><link rel="prefetch" href="/assets/index.html-CRR46Q79.js" as="script"><link rel="prefetch" href="/assets/index.html-X36h9xAV.js" as="script"><link rel="prefetch" href="/assets/index.html-Db4ciJxl.js" as="script"><link rel="prefetch" href="/assets/index.html-B9-qp9Zv.js" as="script"><link rel="prefetch" href="/assets/index.html-BRwRkKjq.js" as="script"><link rel="prefetch" href="/assets/index.html-DkNN0Ggn.js" as="script"><link rel="prefetch" href="/assets/index.html-BevbfSBP.js" as="script"><link rel="prefetch" href="/assets/index.html-DGKoOKvk.js" as="script"><link rel="prefetch" href="/assets/index.html-CczDofwy.js" as="script"><link rel="prefetch" href="/assets/index.html-DrRa28Ct.js" as="script"><link rel="prefetch" href="/assets/index.html-CsU1DR0W.js" as="script"><link rel="prefetch" href="/assets/index.html-Dlzay4Hw.js" as="script"><link rel="prefetch" href="/assets/index.html-LsMzeSDA.js" as="script"><link rel="prefetch" href="/assets/00.åˆ†å¸ƒå¼äº‹åŠ¡ç»„ä»¶Seata.html-DvBICF5t.js" as="script"><link rel="prefetch" href="/assets/index.html-RaZGZNi3.js" as="script"><link rel="prefetch" href="/assets/index.html-D3wsEvzo.js" as="script"><link rel="prefetch" href="/assets/index.html-JrOC7KC5.js" as="script"><link rel="prefetch" href="/assets/index.html-By_gwF0J.js" as="script"><link rel="prefetch" href="/assets/index.html-qWKG5AAK.js" as="script"><link rel="prefetch" href="/assets/index.html-avZIruPQ.js" as="script"><link rel="prefetch" href="/assets/06.MySQLäº‹åŠ¡åŸç†ä¸ä¼˜åŒ–æœ€ä½³å®è·µ.html-CSvQNied.js" as="script"><link rel="prefetch" href="/assets/07.MySQLé”æœºåˆ¶ä¸ä¼˜åŒ–å®è·µä»¥åŠMVCCåº•å±‚åŸç†å‰–æ.html-C23WGqOw.js" as="script"><link rel="prefetch" href="/assets/index.html-Cn4Gzbph.js" as="script"><link rel="prefetch" href="/assets/index.html-uCyFZumH.js" as="script"><link rel="prefetch" href="/assets/index.html-Bm22WFrJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CSd8d20G.js" as="script"><link rel="prefetch" href="/assets/index.html-CvtEazEf.js" as="script"><link rel="prefetch" href="/assets/index.html-BeAXTpGW.js" as="script"><link rel="prefetch" href="/assets/20.ShardingJDBCæºç ä¸å†…æ ¸è§£æ.html-CwyPvd-u.js" as="script"><link rel="prefetch" href="/assets/index.html-DHNMdh3m.js" as="script"><link rel="prefetch" href="/assets/index.html-CCd71ZlA.js" as="script"><link rel="prefetch" href="/assets/index.html-ynJ_kUEc.js" as="script"><link rel="prefetch" href="/assets/index.html-BVfeOYGv.js" as="script"><link rel="prefetch" href="/assets/index.html-CZxOdSnk.js" as="script"><link rel="prefetch" href="/assets/index.html-B-iFN7DD.js" as="script"><link rel="prefetch" href="/assets/index.html-uTIDrkZJ.js" as="script"><link rel="prefetch" href="/assets/index.html-DazyV-CZ.js" as="script"><link rel="prefetch" href="/assets/index.html-DHXS2c57.js" as="script"><link rel="prefetch" href="/assets/index.html-_Fwj-qwX.js" as="script"><link rel="prefetch" href="/assets/index.html-CSa7fUHZ.js" as="script"><link rel="prefetch" href="/assets/index.html-CrqWKted.js" as="script"><link rel="prefetch" href="/assets/index.html-DzjXF5r0.js" as="script"><link rel="prefetch" href="/assets/index.html-QNlXUK6I.js" as="script"><link rel="prefetch" href="/assets/index.html-BDUKsSrh.js" as="script"><link rel="prefetch" href="/assets/index.html-CE1fU4lb.js" as="script"><link rel="prefetch" href="/assets/index.html-IKd9LHPY.js" as="script"><link rel="prefetch" href="/assets/index.html-BNrR4y_n.js" as="script"><link rel="prefetch" href="/assets/index.html-DfI_4yCq.js" as="script"><link rel="prefetch" href="/assets/index.html-0esUAKmz.js" as="script"><link rel="prefetch" href="/assets/index.html-DAH0eLXe.js" as="script"><link rel="prefetch" href="/assets/404.html-BBVwT601.js" as="script"><link rel="prefetch" href="/assets/index.html-9nyom5YJ.js" as="script"><link rel="prefetch" href="/assets/index.html-Dgaj-2Bf.js" as="script"><link rel="prefetch" href="/assets/index.html-BG3rmTga.js" as="script"><link rel="prefetch" href="/assets/index.html-C2MGwNwF.js" as="script"><link rel="prefetch" href="/assets/index.html-oFdCiLjS.js" as="script"><link rel="prefetch" href="/assets/index.html-BsOyCIBe.js" as="script"><link rel="prefetch" href="/assets/index.html-D6eGZPOp.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script"><link rel="prefetch" href="/assets/SearchResult-BFy21v4C.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><!----><!----><!----></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="é¦–é¡µ"><span class="font-icon icon circle-question" style=""></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link active" href="/pages/" aria-label="æ–‡æ¡£"><span class="font-icon icon circle-question" style=""></span>æ–‡æ¡£<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">åˆ†å¸ƒå¼</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">å®¹å™¨</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">å¹¶å‘ç¼–ç¨‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">å¾®æœåŠ¡</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">00. Spring BootåŸç†</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">10. Spring Cloud Alibaba</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><!----><span class="vp-sidebar-title">Nacos</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/pages/13f0c8/" aria-label="Nacosæ³¨å†Œä¸­å¿ƒ"><!---->Nacosæ³¨å†Œä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/pages/2491fa/" aria-label="Nacosé…ç½®ä¸­å¿ƒ"><!---->Nacosé…ç½®ä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#é…ç½®ä¸­å¿ƒ" aria-label="é…ç½®ä¸­å¿ƒ"><!---->é…ç½®ä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#ä»€ä¹ˆæ˜¯nacosé…ç½®ä¸­å¿ƒ" aria-label="ä»€ä¹ˆæ˜¯Nacosé…ç½®ä¸­å¿ƒ"><!---->ä»€ä¹ˆæ˜¯Nacosé…ç½®ä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„" aria-label="Nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„"><!---->Nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#spring-cloud-æ•´åˆnacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹" aria-label="Spring Cloud æ•´åˆNacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹"><!---->Spring Cloud æ•´åˆNacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#configç›¸å…³é…ç½®" aria-label="Configç›¸å…³é…ç½®"><!---->Configç›¸å…³é…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#é…ç½®çš„ä¼˜å…ˆçº§" aria-label="é…ç½®çš„ä¼˜å…ˆçº§"><!---->é…ç½®çš„ä¼˜å…ˆçº§<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#refreshscopeå®ç°åŠ¨æ€æ„ŸçŸ¥" aria-label="@RefreshScopeå®ç°åŠ¨æ€æ„ŸçŸ¥"><!---->@RefreshScopeå®ç°åŠ¨æ€æ„ŸçŸ¥<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ" aria-label="Nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ"><!---->Nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#nacos-config-clientæºç åˆ†æ" aria-label="nacos config clientæºç åˆ†æ"><!---->nacos config clientæºç åˆ†æ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a class="route-link nav-link vp-sidebar-link vp-heading" href="/pages/2491fa/#nacos-config-serveræºç åˆ†æ" aria-label="nacos config serveræºç åˆ†æ"><!---->nacos config serveræºç åˆ†æ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">Seata</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æ€§èƒ½è°ƒä¼˜</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æºç æ¡†æ¶</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">ç®—æ³•</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">è®¡ç®—æœºç½‘ç»œ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">é¢è¯•</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Nacosé…ç½®ä¸­å¿ƒ</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">æ±Ÿ</span></span><span property="author" content="æ±Ÿ"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-13T04:02:35.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 10 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT10M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#é…ç½®ä¸­å¿ƒ">é…ç½®ä¸­å¿ƒ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#ä»€ä¹ˆæ˜¯nacosé…ç½®ä¸­å¿ƒ">ä»€ä¹ˆæ˜¯Nacosé…ç½®ä¸­å¿ƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„">Nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#spring-cloud-æ•´åˆnacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹">Spring Cloud æ•´åˆNacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#configç›¸å…³é…ç½®">Configç›¸å…³é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#é…ç½®çš„ä¼˜å…ˆçº§">é…ç½®çš„ä¼˜å…ˆçº§</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#refreshscopeå®ç°åŠ¨æ€æ„ŸçŸ¥">@RefreshScopeå®ç°åŠ¨æ€æ„ŸçŸ¥</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level2" href="/#nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ">Nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#nacos-config-clientæºç åˆ†æ">nacos config clientæºç åˆ†æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="route-link toc-link level3" href="/#nacos-config-serveræºç åˆ†æ">nacos config serveræºç åˆ†æ</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#é…ç½®ä¸­å¿ƒ"><span>é…ç½®ä¸­å¿ƒ</span></a></h2><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå½“ç³»ç»Ÿä»ä¸€ä¸ªå•ä½“åº”ç”¨ï¼Œè¢«æ‹†åˆ†æˆåˆ†å¸ƒå¼ç³»ç»Ÿä¸Šä¸€ä¸ªä¸ªæœåŠ¡èŠ‚ç‚¹åï¼Œé…ç½®æ–‡ä»¶ä¹Ÿå¿…é¡»è·Ÿç€è¿ç§»ï¼ˆåˆ†å‰²ï¼‰ï¼Œè¿™æ ·é…ç½®å°±åˆ†æ•£äº†ï¼Œä¸ä»…å¦‚æ­¤ï¼Œåˆ†æ•£ä¸­è¿˜åŒ…å«ç€å†—ä½™ã€‚é…ç½®ä¸­å¿ƒå°†é…ç½®ä»å„åº”ç”¨ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œå¯¹é…ç½®è¿›è¡Œç»Ÿä¸€ç®¡ç†ï¼Œåº”ç”¨è‡ªèº«ä¸éœ€è¦è‡ªå·±å»ç®¡ç†é…ç½®ã€‚</p><p><img src="https://img.jssjqd.cn/202304130403361.png" alt="image-20230413040338301"></p><p>é…ç½®ä¸­å¿ƒçš„æœåŠ¡æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>ç”¨æˆ·åœ¨é…ç½®ä¸­å¿ƒæ›´æ–°é…ç½®ä¿¡æ¯ã€‚</li><li>æœåŠ¡Aå’ŒæœåŠ¡BåŠæ—¶å¾—åˆ°é…ç½®æ›´æ–°é€šçŸ¥ï¼Œä»é…ç½®ä¸­å¿ƒè·å–é…ç½®ã€‚</li></ol><p>é…ç½®ä¸­å¿ƒå°±æ˜¯ä¸€ç§ç»Ÿä¸€ç®¡ç†å„ç§åº”ç”¨é…ç½®çš„åŸºç¡€æœåŠ¡ç»„ä»¶ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯nacosé…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯nacosé…ç½®ä¸­å¿ƒ"><span>ä»€ä¹ˆæ˜¯Nacosé…ç½®ä¸­å¿ƒ</span></a></h3><p>å®˜æ–¹æ–‡æ¡£ï¼š https://github.com/alibaba/spring-cloud-alibaba/wiki/Nacos-config</p><p>Nacos æä¾›ç”¨äºå­˜å‚¨é…ç½®å’Œå…¶ä»–å…ƒæ•°æ®çš„ key/value å­˜å‚¨ï¼Œä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤–éƒ¨åŒ–é…ç½®æä¾›æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ”¯æŒã€‚ä½¿ç”¨ Spring Cloud Alibaba Nacos Configï¼Œæ‚¨å¯ä»¥åœ¨ Nacos Server é›†ä¸­ç®¡ç†ä½  Spring Cloud åº”ç”¨çš„å¤–éƒ¨å±æ€§é…ç½®ã€‚</p><p>â€‹ <img src="https://img.jssjqd.cn/202304130404369.png" alt="image-20230413040437405"></p><h3 id="nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„" tabindex="-1"><a class="header-anchor" href="#nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„"><span>Nacosé…ç½®ä¸­å¿ƒçš„æ¶æ„</span></a></h3><p>â€‹ <img src="https://img.jssjqd.cn/202304130404154.png" alt="image-20230413040449180"></p><h4 id="nacosé…ç½®ä¸­å¿ƒæ ¸å¿ƒapi" tabindex="-1"><a class="header-anchor" href="#nacosé…ç½®ä¸­å¿ƒæ ¸å¿ƒapi"><span>Nacosé…ç½®ä¸­å¿ƒæ ¸å¿ƒAPI</span></a></h4><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigServerDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NacosException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> serverAddr <span class="token operator">=</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> dataId <span class="token operator">=</span> <span class="token string">&quot;nacos-config-demo.yaml&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> group <span class="token operator">=</span> <span class="token string">&quot;DEFAULT_GROUP&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">PropertyKeyConst</span><span class="token punctuation">.</span><span class="token constant">SERVER_ADDR</span><span class="token punctuation">,</span> serverAddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–é…ç½®æœåŠ¡</span>
        <span class="token class-name">ConfigService</span> configService <span class="token operator">=</span> <span class="token class-name">NacosFactory</span><span class="token punctuation">.</span><span class="token function">createConfigService</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–é…ç½®</span>
        <span class="token class-name">String</span> content <span class="token operator">=</span> configService<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ³¨å†Œç›‘å¬å™¨</span>
        configService<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Listener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveConfigInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> configInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;===recieve:&quot;</span> <span class="token operator">+</span> configInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Executor</span> <span class="token function">getExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//å‘å¸ƒé…ç½®</span>
        <span class="token comment">//boolean isPublishOk = configService.publishConfig(dataId, group, &quot;content&quot;);</span>
        <span class="token comment">//System.out.println(isPublishOk);</span>
        <span class="token comment">//å‘é€propertiesæ ¼å¼</span>
        configService<span class="token punctuation">.</span><span class="token function">publishConfig</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span>group<span class="token punctuation">,</span><span class="token string">&quot;common.age=30&quot;</span><span class="token punctuation">,</span> <span class="token class-name">ConfigType</span><span class="token punctuation">.</span><span class="token constant">PROPERTIES</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        content <span class="token operator">=</span> configService<span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span>dataId<span class="token punctuation">,</span> group<span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//        boolean isRemoveOk = configService.removeConfig(dataId, group);</span>
<span class="token comment">//        System.out.println(isRemoveOk);</span>
<span class="token comment">//        Thread.sleep(3000);</span>

<span class="token comment">//        content = configService.getConfig(dataId, group, 5000);</span>
<span class="token comment">//        System.out.println(content);</span>
<span class="token comment">//        Thread.sleep(300000);</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="spring-cloud-æ•´åˆnacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹" tabindex="-1"><a class="header-anchor" href="#spring-cloud-æ•´åˆnacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹"><span>Spring Cloud æ•´åˆNacosé…ç½®ä¸­å¿ƒå¿«é€Ÿå¼€å§‹</span></a></h3><h4 id="nacos-serveré…ç½®ä¸­å¿ƒä¸­å‡†å¤‡é…ç½®æ•°æ®" tabindex="-1"><a class="header-anchor" href="#nacos-serveré…ç½®ä¸­å¿ƒä¸­å‡†å¤‡é…ç½®æ•°æ®"><span>nacos serveré…ç½®ä¸­å¿ƒä¸­å‡†å¤‡é…ç½®æ•°æ®</span></a></h4><p>nacos serverä¸­æ–°å»ºnacos-config.properties</p><p><img src="https://img.jssjqd.cn/202304130406493.png" alt="image-20230413040614713"></p><p>â€‹ <img src="https://img.jssjqd.cn/202304130406419.png" alt="image-20230413040619457"></p><h4 id="å¾®æœåŠ¡æ¥å…¥é…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#å¾®æœåŠ¡æ¥å…¥é…ç½®ä¸­å¿ƒ"><span>å¾®æœåŠ¡æ¥å…¥é…ç½®ä¸­å¿ƒ</span></a></h4><p><strong>1ï¼‰å¼•å…¥ä¾èµ–</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2ï¼‰æ·»åŠ bootstrap.properties</strong></p><p>æ³¨æ„ï¼šå¿…é¡»ä½¿ç”¨ bootstrap.properties é…ç½®æ–‡ä»¶æ¥é…ç½®Nacos Server åœ°å€</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">nacos-config</span>
<span class="token comment"># é…ç½®ä¸­å¿ƒåœ°å€</span>
<span class="token key attr-name">spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>

<span class="token comment"># dataid ä¸º yaml çš„æ–‡ä»¶æ‰©å±•åé…ç½®æ–¹å¼</span>
<span class="token key attr-name">spring.cloud.nacos.config.file-extension</span><span class="token punctuation">=</span><span class="token value attr-value">yaml</span>
<span class="token comment">#profileç²’åº¦çš„é…ç½®   `${spring.application.name}-${profile}.${file-extension:properties}`</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ Nacos Spring Cloud ä¸­ï¼ŒdataId çš„å®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š${prefix}-${spring.profiles.active}.${file-extension}</p><ul><li>prefix é»˜è®¤ä¸º spring.application.name çš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é¡¹ spring.cloud.nacos.config.prefixæ¥é…ç½®ã€‚</li><li>spring.profiles.active å³ä¸ºå½“å‰ç¯å¢ƒå¯¹åº”çš„ profileï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html#boot-features-profiles" target="_blank" rel="noopener noreferrer">Spring Bootæ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚ æ³¨æ„ï¼šå½“ spring.profiles.active ä¸ºç©ºæ—¶ï¼Œå¯¹åº”çš„è¿æ¥ç¬¦ - ä¹Ÿå°†ä¸å­˜åœ¨ï¼ŒdataId çš„æ‹¼æ¥æ ¼å¼å˜æˆ ${prefix}.${file-extension}</li><li>file-exetension ä¸ºé…ç½®å†…å®¹çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹ spring.cloud.nacos.config.file-extension æ¥é…ç½®ã€‚</li></ul><p><strong>3) å¯åŠ¨æœåŠ¡ï¼Œæµ‹è¯•å¾®æœåŠ¡æ˜¯å¦ä½¿ç”¨é…ç½®ä¸­å¿ƒçš„é…ç½®</strong></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>@SpringBootApplication
public class NacosConfigApplication {

    public static void main(String[] args) {
        ConfigurableApplicationContext applicationContext = SpringApplication.run(NacosConfigApplication.class, args);
        String userName = applicationContext.getEnvironment().getProperty(&quot;common.name&quot;);
        String userAge = applicationContext.getEnvironment().getProperty(&quot;common.age&quot;);
        System.out.println(&quot;common name :&quot;+userName+&quot;; age: &quot;+userAge);
    }
 }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://img.jssjqd.cn/202304130408948.png" alt="image-20230413040809950"></p><h3 id="configç›¸å…³é…ç½®" tabindex="-1"><a class="header-anchor" href="#configç›¸å…³é…ç½®"><span>Configç›¸å…³é…ç½®</span></a></h3><p>Nacos æ•°æ®æ¨¡å‹ Key ç”±ä¸‰å…ƒç»„å”¯ä¸€ç¡®å®š, Namespaceé»˜è®¤æ˜¯ç©ºä¸²ï¼Œå…¬å…±å‘½åç©ºé—´ï¼ˆpublicï¼‰ï¼Œåˆ†ç»„é»˜è®¤æ˜¯ DEFAULT_GROUP</p><p>â€‹ <img src="https://img.jssjqd.cn/202304130408166.png" alt="image-20230413040825067"></p><ul><li><strong>æ”¯æŒé…ç½®çš„åŠ¨æ€æ›´æ–°</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosConfigApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigurableApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NacosConfigApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//å½“åŠ¨æ€é…ç½®åˆ·æ–°æ—¶ï¼Œä¼šæ›´æ–°åˆ° Enviromentä¸­ï¼Œå› æ­¤è¿™é‡Œæ¯éš”ä¸€ç§’ä¸­ä»Enviromentä¸­è·å–é…ç½®</span>
         <span class="token class-name">String</span> userName <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;common.name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> userAge <span class="token operator">=</span> applicationContext<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;common.age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;common name :&quot;</span> <span class="token operator">+</span> userName <span class="token operator">+</span> <span class="token string">&quot;; age: &quot;</span> <span class="token operator">+</span> userAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æ”¯æŒprofileç²’åº¦çš„é…ç½®</strong></li></ul><p>spring-cloud-starter-alibaba-nacos-config åœ¨åŠ è½½é…ç½®çš„æ—¶å€™ï¼Œä¸<strong>ä»…ä»…åŠ è½½äº†ä»¥ dataid ä¸º ${spring.application.name}.${file-extension:properties} ä¸ºå‰ç¼€çš„åŸºç¡€é…ç½®ï¼Œè¿˜åŠ è½½äº†dataidä¸º ${spring.application.name}-${profile}.${file-extension:properties} çš„åŸºç¡€é…ç½®</strong>ã€‚åœ¨æ—¥å¸¸å¼€å‘ä¸­å¦‚æœé‡åˆ°å¤šå¥—ç¯å¢ƒä¸‹çš„ä¸åŒé…ç½®ï¼Œå¯ä»¥é€šè¿‡Spring æä¾›çš„ ${spring.profiles.active} è¿™ä¸ªé…ç½®é¡¹æ¥é…ç½®ã€‚</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
<span class="token key attr-name">æ”¯æŒè‡ªå®šä¹‰</span> <span class="token value attr-value">namespace çš„é…ç½®</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æ”¯æŒè‡ªå®šä¹‰ namespace çš„é…ç½®</strong></li></ul><p>ç”¨äºè¿›è¡Œç§Ÿæˆ·ç²’åº¦çš„é…ç½®éš”ç¦»ã€‚ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œå¯ä»¥å­˜åœ¨ç›¸åŒçš„ Group æˆ– Data ID çš„é…ç½®ã€‚Namespace çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒç¯å¢ƒçš„é…ç½®çš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„èµ„æºï¼ˆå¦‚é…ç½®ã€æœåŠ¡ï¼‰éš”ç¦»ç­‰ã€‚</p><p>åœ¨æ²¡æœ‰æ˜ç¡®æŒ‡å®š ${spring.cloud.nacos.config.namespace} é…ç½®çš„æƒ…å†µä¸‹ï¼Œ é»˜è®¤ä½¿ç”¨çš„æ˜¯ Nacos ä¸Š Public è¿™ä¸ªnamespaceã€‚å¦‚æœéœ€è¦ä½¿ç”¨è‡ªå®šä¹‰çš„å‘½åç©ºé—´ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®æ¥å®ç°ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.cloud.nacos.config.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">71bb9785-231f-4eca-b4dc-6be446e12ff8</span>
<span class="token key attr-name">æ”¯æŒè‡ªå®šä¹‰</span> <span class="token value attr-value">Group çš„é…ç½®</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æ”¯æŒè‡ªå®šä¹‰ Group çš„é…ç½®</strong></li></ul><p>Groupæ˜¯ç»„ç»‡é…ç½®çš„ç»´åº¦ä¹‹ä¸€ã€‚é€šè¿‡ä¸€ä¸ªæœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ Buy æˆ– Trade ï¼‰å¯¹é…ç½®é›†è¿›è¡Œåˆ†ç»„ï¼Œä»è€ŒåŒºåˆ† Data ID ç›¸åŒçš„é…ç½®é›†ã€‚å½“æ‚¨åœ¨ Nacos ä¸Šåˆ›å»ºä¸€ä¸ªé…ç½®æ—¶ï¼Œå¦‚æœæœªå¡«å†™é…ç½®åˆ†ç»„çš„åç§°ï¼Œåˆ™é…ç½®åˆ†ç»„çš„åç§°é»˜è®¤é‡‡ç”¨ DEFAULT_GROUP ã€‚é…ç½®åˆ†ç»„çš„å¸¸è§åœºæ™¯ï¼šä¸åŒçš„åº”ç”¨æˆ–ç»„ä»¶ä½¿ç”¨äº†ç›¸åŒçš„é…ç½®ç±»å‹ï¼Œå¦‚ database_url é…ç½®å’Œ MQ_topic é…ç½®ã€‚</p><p>åœ¨æ²¡æœ‰æ˜ç¡®æŒ‡å®š ${spring.cloud.nacos.config.group} é…ç½®çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤æ˜¯DEFAULT_GROUP ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰è‡ªå·±çš„ Groupï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®æ¥å®ç°ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token key attr-name">spring.cloud.nacos.config.group</span><span class="token punctuation">=</span><span class="token value attr-value">DEVELOP_GROUP</span>
<span class="token key attr-name">æ”¯æŒè‡ªå®šä¹‰æ‰©å±•çš„</span> <span class="token value attr-value">Data Id é…ç½®</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æ”¯æŒè‡ªå®šä¹‰æ‰©å±•çš„ Data Id é…ç½®</strong></li></ul><p>Data ID æ˜¯ç»„ç»‡åˆ’åˆ†é…ç½®çš„ç»´åº¦ä¹‹ä¸€ã€‚Data ID é€šå¸¸ç”¨äºç»„ç»‡åˆ’åˆ†ç³»ç»Ÿçš„é…ç½®é›†ã€‚ä¸€ä¸ªç³»ç»Ÿæˆ–è€…åº”ç”¨å¯ä»¥åŒ…å«å¤šä¸ªé…ç½®é›†ï¼Œæ¯ä¸ªé…ç½®é›†éƒ½å¯ä»¥è¢«ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°æ ‡è¯†ã€‚Data ID é€šå¸¸é‡‡ç”¨ç±» Java åŒ…ï¼ˆå¦‚ com.taobao.tc.refund.log.levelï¼‰çš„å‘½åè§„åˆ™ä¿è¯å…¨å±€å”¯ä¸€æ€§ã€‚æ­¤å‘½åè§„åˆ™éå¼ºåˆ¶ã€‚</p><p>é€šè¿‡è‡ªå®šä¹‰æ‰©å±•çš„ Data Id é…ç½®ï¼Œæ—¢å¯ä»¥è§£å†³å¤šä¸ªåº”ç”¨é—´é…ç½®å…±äº«çš„é—®é¢˜ï¼Œåˆå¯ä»¥æ”¯æŒä¸€ä¸ªåº”ç”¨æœ‰å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="token comment"># è‡ªå®šä¹‰ Data Id çš„é…ç½®</span>
<span class="token comment">#ä¸åŒå·¥ç¨‹çš„é€šç”¨é…ç½® æ”¯æŒå…±äº«çš„ DataId</span>
<span class="token key attr-name">spring.cloud.nacos.config.sharedConfigs[0].data-id</span><span class="token punctuation">=</span> <span class="token value attr-value">common.yaml</span>
<span class="token key attr-name">spring.cloud.nacos.config.sharedConfigs[0].group</span><span class="token punctuation">=</span><span class="token value attr-value">REFRESH_GROUP</span>
<span class="token key attr-name">spring.cloud.nacos.config.sharedConfigs[0].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token comment"># config external configuration</span>
<span class="token comment"># æ”¯æŒä¸€ä¸ªåº”ç”¨å¤šä¸ª DataId çš„é…ç½®</span>
<span class="token key attr-name">spring.cloud.nacos.config.extensionConfigs[0].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">ext-config-common01.properties</span>
<span class="token key attr-name">spring.cloud.nacos.config.extensionConfigs[0].group</span><span class="token punctuation">=</span><span class="token value attr-value">REFRESH_GROUP</span>
<span class="token key attr-name">spring.cloud.nacos.config.extensionConfigs[0].refresh</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>

<span class="token key attr-name">spring.cloud.nacos.config.extensionConfigs[1].data-id</span><span class="token punctuation">=</span><span class="token value attr-value">ext-config-common02.properties</span>
<span class="token key attr-name">spring.cloud.nacos.config.extensionConfigs[1].group</span><span class="token punctuation">=</span><span class="token value attr-value">REFRESH_GROUP</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é…ç½®çš„ä¼˜å…ˆçº§" tabindex="-1"><a class="header-anchor" href="#é…ç½®çš„ä¼˜å…ˆçº§"><span>é…ç½®çš„ä¼˜å…ˆçº§</span></a></h3><p>Spring Cloud Alibaba Nacos Config ç›®å‰æä¾›äº†ä¸‰ç§é…ç½®èƒ½åŠ›ä» Nacos æ‹‰å–ç›¸å…³çš„é…ç½®ã€‚</p><ul><li>A: é€šè¿‡ spring.cloud.nacos.config.shared-configs æ”¯æŒå¤šä¸ªå…±äº« Data Id çš„é…ç½®</li><li>B: é€šè¿‡ spring.cloud.nacos.config.ext-config[n].data-id çš„æ–¹å¼æ”¯æŒå¤šä¸ªæ‰©å±• Data Id çš„é…ç½®</li><li>C: é€šè¿‡å†…éƒ¨ç›¸å…³è§„åˆ™(åº”ç”¨åã€åº”ç”¨å+ Profile )è‡ªåŠ¨ç”Ÿæˆç›¸å…³çš„ Data Id é…ç½®</li></ul><p>å½“ä¸‰ç§æ–¹å¼å…±åŒä½¿ç”¨æ—¶ï¼Œä»–ä»¬çš„ä¸€ä¸ªä¼˜å…ˆçº§å…³ç³»æ˜¯:A &lt; B &lt; C</p><p>ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š</p><ul><li>${spring.application.name}-${profile}.${file-extension:properties}</li><li>${spring.application.name}.${file-extension:properties}</li><li>${spring.application.name}</li><li>extensionConfigs ä¸€ä¸ªå¾®æœåŠ¡çš„å¤šä¸ªé…ç½®ï¼Œæ¯”å¦‚ nacos,mybatis</li><li>sharedConfigs å¤šä¸ªå¾®æœåŠ¡å…¬å…±é…ç½®ï¼Œæ¯”å¦‚ redis</li></ul><h3 id="refreshscopeå®ç°åŠ¨æ€æ„ŸçŸ¥" tabindex="-1"><a class="header-anchor" href="#refreshscopeå®ç°åŠ¨æ€æ„ŸçŸ¥"><span>@RefreshScopeå®ç°åŠ¨æ€æ„ŸçŸ¥</span></a></h3><p>@Valueæ³¨è§£å¯ä»¥è·å–åˆ°é…ç½®ä¸­å¿ƒçš„å€¼ï¼Œä½†æ˜¯æ— æ³•åŠ¨æ€æ„ŸçŸ¥ä¿®æ”¹åçš„å€¼ï¼Œéœ€è¦åˆ©ç”¨@RefreshScopeæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${common.age}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> age<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/common&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>@RefreshScope å¯¼è‡´@Scheduledå®šæ—¶ä»»åŠ¡å¤±æ•ˆé—®é¢˜</strong></p><p>å½“åˆ©ç”¨@RefreshScopeåˆ·æ–°é…ç½®åä¼šå¯¼è‡´å®šæ—¶ä»»åŠ¡å¤±æ•ˆ</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableScheduling</span>   <span class="token comment">// å¼€å¯å®šæ—¶ä»»åŠ¡åŠŸèƒ½</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosConfigApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>  <span class="token comment">//åŠ¨æ€æ„ŸçŸ¥ä¿®æ”¹åçš„å€¼</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${common.age}&quot;</span><span class="token punctuation">)</span>
     <span class="token class-name">String</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${common.name}&quot;</span><span class="token punctuation">)</span>
     <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/common&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è§¦å‘@RefreshScopeæ‰§è¡Œé€»è¾‘ä¼šå¯¼è‡´@Scheduledå®šæ—¶ä»»åŠ¡å¤±æ•ˆ</span>
    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;*/3 * * * * ?&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//å®šæ—¶ä»»åŠ¡æ¯éš”3sæ‰§è¡Œä¸€æ¬¡</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å®šæ—¶ä»»åŠ¡æ­£å¸¸æ‰§è¡Œã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç»“æœï¼š</p><ul><li>å½“åœ¨é…ç½®ä¸­å¿ƒå˜æ›´å±æ€§åï¼Œå®šæ—¶ä»»åŠ¡å¤±æ•ˆ</li><li>å½“å†æ¬¡è®¿é—®http://localhost:8010/commonï¼Œå®šæ—¶ä»»åŠ¡ç”Ÿæ•ˆ</li></ul><p>åŸå› ï¼š@RefreshScopeä¿®é¥°çš„beançš„å±æ€§å‘ç”Ÿå˜æ›´åï¼Œä¼šä»ç¼“å­˜ä¸­æ¸…é™¤ã€‚æ­¤æ—¶æ²¡æœ‰è¿™ä¸ªbeanï¼Œå®šæ—¶ä»»åŠ¡å½“ç„¶ä¹Ÿå°±ä¸ç”Ÿæ•ˆäº†ã€‚</p><p>è¯¦ç»†åŸå› å¦‚ä¸‹ï¼š</p><ol><li>@RefreshScope æ³¨è§£æ ‡æ³¨äº†@Scope æ³¨è§£ï¼Œå¹¶é»˜è®¤äº†ScopedProxyMode.TARGET_CLASSå±æ€§ï¼Œæ­¤å±æ€§çš„åŠŸèƒ½å°±æ˜¯åˆ›å»ºä¸€ä¸ªä»£ç†ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½ç”¨å®ƒæ¥è°ƒç”¨GenericScope#get æ–¹æ³•æ¥è·å–beanå¯¹è±¡ã€‚</li><li>åœ¨GenericScope é‡Œé¢åŒ…è£…äº†ä¸€ä¸ªå†…éƒ¨ç±» BeanLifecycleWrapperCache æ¥å¯¹åŠ äº† @RefreshScope çš„beanè¿›è¡Œç¼“å­˜ï¼Œä½¿å…¶åœ¨ä¸åˆ·æ–°æ—¶è·å–çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</li><li>å¦‚å±æ€§å‘ç”Ÿå˜æ›´ä¼šè°ƒç”¨ ContextRefresher#refresh()â€”â€”&gt;RefreshScope#refreshAll() è¿›è¡Œç¼“å­˜æ¸…ç†æ–¹æ³•è°ƒç”¨ï¼Œå¹¶å‘é€åˆ·æ–°äº‹ä»¶é€šçŸ¥ â€”â€”&gt; è°ƒç”¨GenericScope#destroy() å®ç°æ¸…ç†ç¼“å­˜</li><li>å½“ä¸‹ä¸€æ¬¡ä½¿ç”¨æ­¤beanå¯¹è±¡æ—¶ï¼Œä»£ç†å¯¹è±¡ä¼šè°ƒç”¨GenericScope#get(String name, ObjectFactory objectFactory) æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„beanå¯¹è±¡ï¼Œå¹¶å­˜å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶æ–°å¯¹è±¡å› ä¸ºSpring çš„è£…é…æœºåˆ¶å°±æ˜¯æ–°çš„å±æ€§äº†</li></ol><p>åé¢ä¼šç»“åˆæºç åˆ†æï¼Œæ ¸å¿ƒæºç ï¼šGenericScope#get</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>å®ç°Springäº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬ RefreshScopeRefreshedEventäº‹ä»¶ï¼Œç›‘å¬æ–¹æ³•ä¸­è¿›è¡Œä¸€æ¬¡å®šæ—¶æ–¹æ³•çš„è°ƒç”¨</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span>  <span class="token comment">//åŠ¨æ€æ„ŸçŸ¥ä¿®æ”¹åçš„å€¼</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RefreshScopeRefreshedEvent</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${common.age}&quot;</span><span class="token punctuation">)</span>
     <span class="token class-name">String</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${common.name}&quot;</span><span class="token punctuation">)</span>
     <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/common&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è§¦å‘@RefreshScopeæ‰§è¡Œé€»è¾‘ä¼šå¯¼è‡´@Scheduledå®šæ—¶ä»»åŠ¡å¤±æ•ˆ</span>
    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">&quot;*/3 * * * * ?&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//å®šæ—¶ä»»åŠ¡æ¯éš”3sæ‰§è¡Œä¸€æ¬¡</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å®šæ—¶ä»»åŠ¡æ­£å¸¸æ‰§è¡Œã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">RefreshScopeRefreshedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ" tabindex="-1"><a class="header-anchor" href="#nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ"><span>Nacosé…ç½®ä¸­å¿ƒæºç åˆ†æ</span></a></h2><p>https://www.processon.com/view/link/62d678c31e08531cf8db16ef</p><h3 id="nacos-config-clientæºç åˆ†æ" tabindex="-1"><a class="header-anchor" href="#nacos-config-clientæºç åˆ†æ"><span>nacos config clientæºç åˆ†æ</span></a></h3><p>é…ç½®ä¸­å¿ƒæ ¸å¿ƒæ¥å£ConfigService</p><p><img src="https://img.jssjqd.cn/202304130414926.png" alt="image-20230413041438931"></p><p><strong>è·å–é…ç½®</strong></p><p>è·å–é…ç½®çš„ä¸»è¦æ–¹æ³•æ˜¯ NacosConfigService ç±»çš„ getConfig æ–¹æ³•ï¼Œé€šå¸¸æƒ…å†µä¸‹è¯¥æ–¹æ³•ç›´æ¥ä»æœ¬åœ°æ–‡ä»¶ä¸­å–å¾—é…ç½®çš„å€¼ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…å†…å®¹ä¸ºç©ºï¼Œåˆ™å†é€šè¿‡grpcä»è¿œç«¯æ‹‰å–é…ç½®ï¼Œå¹¶ä¿å­˜åˆ°æœ¬åœ°å¿«ç…§ä¸­ã€‚</p><p>â€‹ <img src="https://img.jssjqd.cn/202304130414985.png" alt="image-20230413041451053"></p><p><strong>æ³¨å†Œç›‘å¬å™¨</strong></p><p>é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯ä¼šé€šè¿‡å¯¹é…ç½®é¡¹æ³¨å†Œç›‘å¬å™¨è¾¾åˆ°åœ¨é…ç½®é¡¹å˜æ›´çš„æ—¶å€™æ‰§è¡Œå›è°ƒçš„åŠŸèƒ½ã€‚</p><div class="language-properties line-numbers-mode" data-ext="properties" data-title="properties"><pre class="language-properties"><code>ConfigService#getConfigAndSignListener
ConfigService#addListener
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Nacos å¯ä»¥é€šè¿‡ä»¥ä¸Šæ–¹å¼æ³¨å†Œç›‘å¬å™¨ï¼Œå®ƒä»¬å†…éƒ¨çš„å®ç°å‡æ˜¯è°ƒç”¨ ClientWorker ç±»çš„ addCacheDataIfAbsentã€‚å…¶ä¸­ CacheData æ˜¯ä¸€ä¸ªç»´æŠ¤é…ç½®é¡¹å’Œå…¶ä¸‹æ³¨å†Œçš„æ‰€æœ‰ç›‘å¬å™¨çš„å®ä¾‹ï¼Œæ‰€æœ‰çš„ CacheData éƒ½ä¿å­˜åœ¨ ClientWorker ç±»ä¸­çš„åŸå­ cacheMap ä¸­ï¼Œå…¶å†…éƒ¨çš„æ ¸å¿ƒæˆå‘˜æœ‰ï¼š</p><p><img src="https://img.jssjqd.cn/202304130415336.png" alt="image-20230413041519702"></p><h3 id="nacos-config-serveræºç åˆ†æ" tabindex="-1"><a class="header-anchor" href="#nacos-config-serveræºç åˆ†æ"><span>nacos config serveræºç åˆ†æ</span></a></h3><p><strong>é…ç½®dump</strong></p><p><img src="https://img.jssjqd.cn/202304130415026.png" alt="image-20230413041537923"></p><p>æœåŠ¡ç«¯å¯åŠ¨æ—¶å°±ä¼šä¾èµ– DumpService çš„ init æ–¹æ³•ï¼Œä»æ•°æ®åº“ä¸­ load é…ç½®å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼Œå¹¶å°†ä¸€äº›é‡è¦çš„å…ƒä¿¡æ¯ä¾‹å¦‚ MD5 å€¼ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚æœåŠ¡ç«¯ä¼šæ ¹æ®å¿ƒè·³æ–‡ä»¶ä¸­ä¿å­˜çš„æœ€åä¸€æ¬¡å¿ƒè·³æ—¶é—´ï¼Œæ¥åˆ¤æ–­åˆ°åº•æ˜¯ä»æ•°æ®åº“ dump å…¨é‡é…ç½®æ•°æ®è¿˜æ˜¯éƒ¨åˆ†å¢é‡é…ç½®æ•°æ®ï¼ˆå¦‚æœæœºå™¨ä¸Šæ¬¡å¿ƒè·³é—´éš”æ˜¯ 6h ä»¥å†…çš„è¯ï¼‰ã€‚</p><p>å…¨é‡ dump å½“ç„¶å…ˆæ¸…ç©ºç£ç›˜ç¼“å­˜ï¼Œç„¶åæ ¹æ®ä¸»é”® ID æ¯æ¬¡æå–ä¸€åƒæ¡é…ç½®åˆ·è¿›ç£ç›˜å’Œå†…å­˜ã€‚å¢é‡ dump å°±æ˜¯æå–æœ€è¿‘å…­å°æ—¶çš„æ–°å¢é…ç½®ï¼ˆåŒ…æ‹¬æ›´æ–°çš„å’Œåˆ é™¤çš„ï¼‰ï¼Œå…ˆæŒ‰ç…§è¿™æ‰¹æ•°æ®åˆ·æ–°ä¸€éå†…å­˜å’Œæ–‡ä»¶ï¼Œå†æ ¹æ®å†…å­˜é‡Œæ‰€æœ‰çš„æ•°æ®å…¨é‡å»æ¯”å¯¹ä¸€éæ•°æ®åº“ï¼Œå¦‚æœæœ‰æ”¹å˜çš„å†åŒæ­¥ä¸€æ¬¡ï¼Œç›¸æ¯”äºå…¨é‡ dump çš„è¯ä¼šå‡å°‘ä¸€å®šçš„æ•°æ®åº“ IO å’Œç£ç›˜ IO æ¬¡æ•°ã€‚</p><p><strong>é…ç½®å‘å¸ƒ</strong></p><p>å‘å¸ƒé…ç½®çš„ä»£ç ä½äº ConfigController#publishConfigä¸­ã€‚é›†ç¾¤éƒ¨ç½²ï¼Œè¯·æ±‚ä¸€å¼€å§‹ä¹Ÿåªä¼šæ‰“åˆ°ä¸€å°æœºå™¨ï¼Œè¿™å°æœºå™¨å°†é…ç½®æ’å…¥Mysqlä¸­è¿›è¡ŒæŒä¹…åŒ–ã€‚æœåŠ¡ç«¯å¹¶ä¸æ˜¯é’ˆå¯¹æ¯æ¬¡é…ç½®æŸ¥è¯¢éƒ½å»è®¿é—® MySQL ï¼Œè€Œæ˜¯ä¼šä¾èµ– dump åŠŸèƒ½åœ¨æœ¬åœ°æ–‡ä»¶ä¸­å°†é…ç½®ç¼“å­˜èµ·æ¥ã€‚å› æ­¤å½“å•å°æœºå™¨ä¿å­˜å®Œæ¯•é…ç½®ä¹‹åï¼Œéœ€è¦é€šçŸ¥å…¶ä»–æœºå™¨åˆ·æ–°å†…å­˜å’Œæœ¬åœ°ç£ç›˜ä¸­çš„æ–‡ä»¶å†…å®¹ï¼Œå› æ­¤å®ƒä¼šå‘å¸ƒä¸€ä¸ªåä¸º ConfigDataChangeEvent çš„äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šé€šè¿‡grpcè°ƒç”¨é€šçŸ¥æ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬è‡ªèº«ï¼‰ï¼Œè§¦å‘æœ¬åœ°æ–‡ä»¶å’Œå†…å­˜çš„åˆ·æ–°ã€‚</p><p><img src="https://img.jssjqd.cn/202304130415319.png" alt="image-20230413041557023"></p></div><!--[--><!----><!--]--><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: thejqd@gmail.com">jiangqingdong</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/pages/13f0c8/" aria-label="Nacosæ³¨å†Œä¸­å¿ƒ"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Nacosæ³¨å†Œä¸­å¿ƒ</div></a><!----></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><!----></div><!--]--><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CT4bPn0M.js" defer></script>
  </body>
</html>
